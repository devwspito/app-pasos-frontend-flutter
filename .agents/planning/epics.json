{
  "_metadata": {
    "agentType": "planning",
    "taskId": "6c006dedb0f6e4171b542793",
    "timestamp": "2026-01-23T11:38:44.530Z",
    "phase": "planning",
    "savedAt": "2026-01-23T11:38:44.530Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "FN63",
    "taskDescription": "Descripción de tareas para completar el frontend en Flutter\n\nCompletar los 9 epics del frontend de la aplicación \"Pasos\" (contador de pasos social) usando Flutter.\n\n================================================================================\n\nCONTEXTO\n\n================================================================================\n\nEl backend ya está completo en: project-app-pasos-backend\n\nEl frontend debe ir en: project-app-pasos-frontend-flutter (crear nueva estructura)\n\nUsar Flutter para aplicación móvil nativa multiplataforma (iOS/Android)\n\n================================================================================\n\nEPICS A IMPLEMENTAR\n\n================================================================================\n\nFLUTTER FOUNDATION\n\nSetup de Flutter + estructura del proyecto\n\nConfiguración de dependencias base (provider/bloc, dio, etc.)\n\nPLATFORM CONFIG\n\nConfiguración para iOS/Android\n\nPermisos para Health APIs (HealthKit/Google Fit)\n\nConfiguración de AndroidManifest.xml y Info.plist\n\nUI FOUNDATION\n\nSistema de diseño con Material Design 3\n\nRouting y navegación (go_router)\n\nTema oscuro/claro (ThemeData)\n\nWidgets reutilizables\n\nAUTH UI\n\nPantallas de login, registro y recuperación de contraseña\n\nGestión de estado de autenticación\n\nAlmacenamiento seguro de tokens (flutter_secure_storage)\n\nDASHBOARD\n\nVista principal con contador de pasos\n\nHistorial de actividad\n\nGráficos (fl_chart o charts_flutter)\n\nPull-to-refresh\n\nSHARING UI\n\nLista de amigos\n\nGestión de compartir datos con amigos\n\nSolicitudes de amistad\n\nVista de actividad de amigos\n\nGOALS UI\n\nGrupos y metas compartidas\n\nCreación y edición de metas\n\nProgreso de grupos\n\nRankings\n\nNATIVE INTEGRATION\n\nIntegración con podómetro nativo usando health package\n\nLectura de pasos desde HealthKit (iOS)\n\nLectura de pasos desde Google Fit/Health Connect (Android)\n\nBackground sync de datos\n\nREAL-TIME CLIENT\n\nIntegración WebSocket con web_socket_channel\n\nActualizaciones en tiempo real\n\nNotificaciones push (firebase_messaging)\n\nManejo de reconexión",
    "epicsCount": 9,
    "epics": [
      {
        "id": "epic-flutter-foundation",
        "title": "Flutter Foundation - Project Setup and Core Infrastructure",
        "description": "Initialize Flutter project with Clean Architecture structure, configure dependencies (riverpod, dio, go_router), set up dependency injection, create base classes for error handling, and establish networking infrastructure",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "pubspec.yaml",
          "analysis_options.yaml",
          "lib/main.dart",
          "lib/core/di/injection_container.dart",
          "lib/core/network/dio_client.dart",
          "lib/core/network/api_endpoints.dart",
          "lib/core/network/interceptors/auth_interceptor.dart",
          "lib/core/network/interceptors/error_interceptor.dart",
          "lib/core/network/interceptors/logging_interceptor.dart",
          "lib/core/errors/exceptions.dart",
          "lib/core/errors/failures.dart",
          "lib/core/utils/constants.dart",
          "lib/core/utils/validators.dart",
          "lib/core/utils/extensions.dart",
          "lib/core/config/app_config.dart",
          "lib/core/config/environment.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/package.json",
          "project-app-pasos-backend/src/types/index.ts"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Clean Architecture with feature-based modules",
          "Dependency injection with get_it",
          "Environment-based configuration"
        ],
        "stories": [
          {
            "id": "story-flutter-init",
            "title": "Initialize Flutter project with pubspec.yaml",
            "description": "Create new Flutter project, configure pubspec.yaml with all required dependencies: dio, riverpod, go_router, flutter_secure_storage, health, web_socket_channel, fl_chart, etc.",
            "filesToCreate": [
              "pubspec.yaml",
              "analysis_options.yaml"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-core-structure",
            "title": "Create core folder structure",
            "description": "Set up lib/core/ with di/, network/, errors/, utils/, config/ directories and base files",
            "filesToCreate": [
              "lib/core/di/injection_container.dart",
              "lib/core/errors/exceptions.dart",
              "lib/core/errors/failures.dart",
              "lib/core/utils/constants.dart",
              "lib/core/config/app_config.dart"
            ],
            "priority": 2,
            "complexity": "simple"
          },
          {
            "id": "story-dio-setup",
            "title": "Configure Dio HTTP client with interceptors",
            "description": "Create DioClient singleton with auth, error, and logging interceptors. Define API endpoints constants matching backend routes: /api/auth/*, /api/steps/*, /api/sharing/*, /api/goals/*",
            "filesToCreate": [
              "lib/core/network/dio_client.dart",
              "lib/core/network/api_endpoints.dart",
              "lib/core/network/interceptors/auth_interceptor.dart",
              "lib/core/network/interceptors/error_interceptor.dart",
              "lib/core/network/interceptors/logging_interceptor.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-main-entry",
            "title": "Create main.dart with app initialization",
            "description": "Configure main.dart with ProviderScope, dependency injection initialization, and app bootstrap",
            "filesToCreate": [
              "lib/main.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-platform-config",
        "title": "Platform Configuration - iOS/Android Health API Setup",
        "description": "Configure iOS (HealthKit) and Android (Google Fit/Health Connect) platform-specific permissions and entitlements for accessing step data from native health APIs",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "ios/Runner/Info.plist",
          "ios/Runner/Runner.entitlements",
          "ios/Podfile",
          "android/app/src/main/AndroidManifest.xml",
          "android/app/build.gradle",
          "android/build.gradle",
          "android/settings.gradle",
          "android/gradle.properties",
          "lib/core/platform/health_permissions.dart",
          "lib/core/platform/platform_info.dart"
        ],
        "filesToRead": [],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-flutter-foundation"
        ],
        "executionOrder": 1,
        "followsPatterns": [
          "Platform-specific configuration in ios/ and android/ directories",
          "Health API permissions follow Apple and Google guidelines"
        ],
        "stories": [
          {
            "id": "story-ios-healthkit",
            "title": "Configure iOS HealthKit permissions",
            "description": "Update Info.plist with NSHealthShareUsageDescription, NSHealthUpdateUsageDescription. Create Runner.entitlements with HealthKit capability. Configure Podfile for health package.",
            "filesToCreate": [
              "ios/Runner/Info.plist",
              "ios/Runner/Runner.entitlements",
              "ios/Podfile"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-android-health",
            "title": "Configure Android Health Connect permissions",
            "description": "Update AndroidManifest.xml with health permissions (ACTIVITY_RECOGNITION, BODY_SENSORS). Configure build.gradle with compileSdk 34+ for Health Connect.",
            "filesToCreate": [
              "android/app/src/main/AndroidManifest.xml",
              "android/app/build.gradle",
              "android/build.gradle"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-platform-utils",
            "title": "Create platform-specific utilities",
            "description": "Create health_permissions.dart for requesting and checking permissions, platform_info.dart for detecting platform capabilities",
            "filesToCreate": [
              "lib/core/platform/health_permissions.dart",
              "lib/core/platform/platform_info.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-ui-foundation",
        "title": "UI Foundation - Design System and Navigation",
        "description": "Implement Material Design 3 theming with dark/light modes, create go_router navigation configuration, build reusable widget library including buttons, inputs, cards, and loading states",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "lib/core/theme/app_theme.dart",
          "lib/core/theme/app_colors.dart",
          "lib/core/theme/app_text_styles.dart",
          "lib/core/theme/app_spacing.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart",
          "lib/core/router/route_guards.dart",
          "lib/shared/widgets/app_button.dart",
          "lib/shared/widgets/app_text_field.dart",
          "lib/shared/widgets/app_card.dart",
          "lib/shared/widgets/loading_indicator.dart",
          "lib/shared/widgets/error_widget.dart",
          "lib/shared/widgets/empty_state.dart",
          "lib/shared/widgets/avatar_widget.dart",
          "lib/shared/widgets/step_counter_display.dart",
          "lib/app.dart"
        ],
        "filesToRead": [],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-flutter-foundation"
        ],
        "executionOrder": 1,
        "followsPatterns": [
          "Material Design 3 with ColorScheme.fromSeed",
          "ThemeData with light/dark variants",
          "go_router with declarative routing"
        ],
        "stories": [
          {
            "id": "story-theme-setup",
            "title": "Create Material Design 3 theme system",
            "description": "Implement AppTheme with light/dark ThemeData, AppColors with semantic color tokens, AppTextStyles with typography scale, AppSpacing with consistent spacing values",
            "filesToCreate": [
              "lib/core/theme/app_theme.dart",
              "lib/core/theme/app_colors.dart",
              "lib/core/theme/app_text_styles.dart",
              "lib/core/theme/app_spacing.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-router-setup",
            "title": "Configure go_router navigation",
            "description": "Create AppRouter with GoRouter configuration, route_names.dart constants, route_guards.dart for auth protection. Define routes: splash, login, register, dashboard, friends, goals, settings",
            "filesToCreate": [
              "lib/core/router/app_router.dart",
              "lib/core/router/route_names.dart",
              "lib/core/router/route_guards.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-shared-widgets",
            "title": "Build reusable widget library",
            "description": "Create base widgets: AppButton (primary/secondary/outline variants), AppTextField (with validation), AppCard, LoadingIndicator, ErrorWidget, EmptyState, AvatarWidget",
            "filesToCreate": [
              "lib/shared/widgets/app_button.dart",
              "lib/shared/widgets/app_text_field.dart",
              "lib/shared/widgets/app_card.dart",
              "lib/shared/widgets/loading_indicator.dart",
              "lib/shared/widgets/error_widget.dart",
              "lib/shared/widgets/empty_state.dart",
              "lib/shared/widgets/avatar_widget.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-step-display",
            "title": "Create step counter display widget",
            "description": "Build StepCounterDisplay widget showing animated step count with circular progress indicator",
            "filesToCreate": [
              "lib/shared/widgets/step_counter_display.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-app-widget",
            "title": "Create root App widget",
            "description": "Create app.dart with MaterialApp.router, theme provider, and global configurations",
            "filesToCreate": [
              "lib/app.dart"
            ],
            "priority": 5,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-auth-ui",
        "title": "Auth UI - Authentication Screens and Flow",
        "description": "Implement login, registration, and password recovery screens. Create auth state management with Riverpod, secure token storage with flutter_secure_storage, and automatic token refresh flow",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/auth/data/datasources/auth_remote_datasource.dart",
          "lib/features/auth/data/datasources/auth_local_datasource.dart",
          "lib/features/auth/data/repositories/auth_repository_impl.dart",
          "lib/features/auth/data/models/user_model.dart",
          "lib/features/auth/data/models/auth_tokens_model.dart",
          "lib/features/auth/domain/entities/user.dart",
          "lib/features/auth/domain/entities/auth_tokens.dart",
          "lib/features/auth/domain/repositories/auth_repository.dart",
          "lib/features/auth/domain/usecases/login_usecase.dart",
          "lib/features/auth/domain/usecases/register_usecase.dart",
          "lib/features/auth/domain/usecases/logout_usecase.dart",
          "lib/features/auth/domain/usecases/get_current_user_usecase.dart",
          "lib/features/auth/presentation/providers/auth_provider.dart",
          "lib/features/auth/presentation/providers/auth_state.dart",
          "lib/features/auth/presentation/screens/login_screen.dart",
          "lib/features/auth/presentation/screens/register_screen.dart",
          "lib/features/auth/presentation/screens/forgot_password_screen.dart",
          "lib/features/auth/presentation/screens/splash_screen.dart",
          "lib/features/auth/presentation/widgets/auth_form_field.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/auth.routes.ts",
          "project-app-pasos-backend/src/models/User.ts",
          "project-app-pasos-backend/src/services/auth.service.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-ui-foundation",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean Architecture: data/domain/presentation layers",
          "Riverpod StateNotifier for auth state",
          "flutter_secure_storage for token persistence",
          "API endpoints: POST /api/auth/register, POST /api/auth/login, POST /api/auth/refresh, GET /api/auth/me"
        ],
        "stories": [
          {
            "id": "story-auth-domain",
            "title": "Create auth domain layer",
            "description": "Define User entity (id, username, email) and AuthTokens entity (accessToken, refreshToken). Create AuthRepository interface and use cases (LoginUseCase, RegisterUseCase, LogoutUseCase, GetCurrentUserUseCase)",
            "filesToCreate": [
              "lib/features/auth/domain/entities/user.dart",
              "lib/features/auth/domain/entities/auth_tokens.dart",
              "lib/features/auth/domain/repositories/auth_repository.dart",
              "lib/features/auth/domain/usecases/login_usecase.dart",
              "lib/features/auth/domain/usecases/register_usecase.dart",
              "lib/features/auth/domain/usecases/logout_usecase.dart",
              "lib/features/auth/domain/usecases/get_current_user_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-data",
            "title": "Implement auth data layer",
            "description": "Create UserModel and AuthTokensModel with fromJson/toJson. Implement AuthRemoteDataSource calling /api/auth/* endpoints, AuthLocalDataSource for flutter_secure_storage, AuthRepositoryImpl",
            "filesToCreate": [
              "lib/features/auth/data/models/user_model.dart",
              "lib/features/auth/data/models/auth_tokens_model.dart",
              "lib/features/auth/data/datasources/auth_remote_datasource.dart",
              "lib/features/auth/data/datasources/auth_local_datasource.dart",
              "lib/features/auth/data/repositories/auth_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-state",
            "title": "Create auth state management",
            "description": "Implement AuthState sealed class with states (initial, loading, authenticated, unauthenticated, error). Create AuthNotifier extending StateNotifier with login, register, logout, checkAuth methods.",
            "filesToCreate": [
              "lib/features/auth/presentation/providers/auth_state.dart",
              "lib/features/auth/presentation/providers/auth_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-login-screen",
            "title": "Build login screen",
            "description": "Create LoginScreen with email/password fields using AppTextField, validation, login button, forgot password link, and register navigation",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/login_screen.dart",
              "lib/features/auth/presentation/widgets/auth_form_field.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-register-screen",
            "title": "Build registration screen",
            "description": "Create RegisterScreen with username (3-30 chars), email, password (min 6 chars), confirm password fields with real-time validation",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/register_screen.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-splash-screen",
            "title": "Build splash and auth flow screens",
            "description": "Create SplashScreen for initial auth check (check stored tokens, auto-login), ForgotPasswordScreen for password recovery flow",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/splash_screen.dart",
              "lib/features/auth/presentation/screens/forgot_password_screen.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-dashboard",
        "title": "Dashboard - Step Counter and Activity History",
        "description": "Build main dashboard showing current step count with animated counter, daily/weekly step history with charts using fl_chart, pull-to-refresh functionality, and step statistics display",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
          "lib/features/dashboard/data/repositories/steps_repository_impl.dart",
          "lib/features/dashboard/data/models/step_record_model.dart",
          "lib/features/dashboard/data/models/step_stats_model.dart",
          "lib/features/dashboard/data/models/weekly_trend_model.dart",
          "lib/features/dashboard/domain/entities/step_record.dart",
          "lib/features/dashboard/domain/entities/step_stats.dart",
          "lib/features/dashboard/domain/entities/weekly_trend.dart",
          "lib/features/dashboard/domain/repositories/steps_repository.dart",
          "lib/features/dashboard/domain/usecases/get_today_steps_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_weekly_trend_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_hourly_peaks_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_stats_usecase.dart",
          "lib/features/dashboard/domain/usecases/record_steps_usecase.dart",
          "lib/features/dashboard/presentation/providers/dashboard_provider.dart",
          "lib/features/dashboard/presentation/providers/dashboard_state.dart",
          "lib/features/dashboard/presentation/screens/dashboard_screen.dart",
          "lib/features/dashboard/presentation/screens/history_screen.dart",
          "lib/features/dashboard/presentation/screens/stats_screen.dart",
          "lib/features/dashboard/presentation/widgets/step_counter_card.dart",
          "lib/features/dashboard/presentation/widgets/weekly_chart.dart",
          "lib/features/dashboard/presentation/widgets/hourly_chart.dart",
          "lib/features/dashboard/presentation/widgets/stats_card.dart",
          "lib/features/dashboard/presentation/widgets/activity_list_item.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/steps.routes.ts",
          "project-app-pasos-backend/src/models/Step.ts",
          "project-app-pasos-backend/src/services/steps.service.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-auth-ui",
          "epic-ui-foundation",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "fl_chart for data visualization",
          "Pull-to-refresh with RefreshIndicator",
          "Animated number transitions",
          "API endpoints: GET /api/steps/today, GET /api/steps/weekly, GET /api/steps/hourly-peaks, GET /api/steps/stats, POST /api/steps"
        ],
        "stories": [
          {
            "id": "story-steps-domain",
            "title": "Create steps domain layer",
            "description": "Define StepRecord (count, timestamp, source, hour, date), StepStats (today, week, month, allTime), WeeklyTrend (date, total) entities. Create StepsRepository interface and use cases.",
            "filesToCreate": [
              "lib/features/dashboard/domain/entities/step_record.dart",
              "lib/features/dashboard/domain/entities/step_stats.dart",
              "lib/features/dashboard/domain/entities/weekly_trend.dart",
              "lib/features/dashboard/domain/repositories/steps_repository.dart",
              "lib/features/dashboard/domain/usecases/get_today_steps_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_weekly_trend_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_hourly_peaks_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_stats_usecase.dart",
              "lib/features/dashboard/domain/usecases/record_steps_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-steps-data",
            "title": "Implement steps data layer",
            "description": "Create models (StepRecordModel, StepStatsModel, WeeklyTrendModel) with JSON serialization matching backend response. Implement StepsRemoteDataSource and StepsRepositoryImpl.",
            "filesToCreate": [
              "lib/features/dashboard/data/models/step_record_model.dart",
              "lib/features/dashboard/data/models/step_stats_model.dart",
              "lib/features/dashboard/data/models/weekly_trend_model.dart",
              "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
              "lib/features/dashboard/data/repositories/steps_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-state",
            "title": "Create dashboard state management",
            "description": "Implement DashboardState with todaySteps, weeklyTrend, hourlyPeaks, stats, isLoading, error. Create DashboardNotifier for managing dashboard data with refresh capability.",
            "filesToCreate": [
              "lib/features/dashboard/presentation/providers/dashboard_state.dart",
              "lib/features/dashboard/presentation/providers/dashboard_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-screen",
            "title": "Build main dashboard screen",
            "description": "Create DashboardScreen with animated StepCounterCard, daily goal progress ring, quick stats summary, and bottom navigation",
            "filesToCreate": [
              "lib/features/dashboard/presentation/screens/dashboard_screen.dart",
              "lib/features/dashboard/presentation/widgets/step_counter_card.dart",
              "lib/features/dashboard/presentation/widgets/stats_card.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-charts",
            "title": "Build chart widgets with fl_chart",
            "description": "Create WeeklyChart showing 7-day bar chart with date labels, HourlyChart showing 24-hour activity distribution line chart",
            "filesToCreate": [
              "lib/features/dashboard/presentation/widgets/weekly_chart.dart",
              "lib/features/dashboard/presentation/widgets/hourly_chart.dart"
            ],
            "priority": 5,
            "complexity": "complex"
          },
          {
            "id": "story-history-screen",
            "title": "Build history and stats screens",
            "description": "Create HistoryScreen with scrollable list of past activity grouped by date, StatsScreen with detailed statistics (today/week/month/allTime)",
            "filesToCreate": [
              "lib/features/dashboard/presentation/screens/history_screen.dart",
              "lib/features/dashboard/presentation/screens/stats_screen.dart",
              "lib/features/dashboard/presentation/widgets/activity_list_item.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-sharing-ui",
        "title": "Sharing UI - Friends and Social Features",
        "description": "Implement friends list, friend request management, user search for adding friends, shared activity view showing friends' step counts, and friend profile screens",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
          "lib/features/sharing/data/repositories/sharing_repository_impl.dart",
          "lib/features/sharing/data/models/sharing_relationship_model.dart",
          "lib/features/sharing/data/models/shared_user_stats_model.dart",
          "lib/features/sharing/domain/entities/sharing_relationship.dart",
          "lib/features/sharing/domain/entities/shared_user_stats.dart",
          "lib/features/sharing/domain/repositories/sharing_repository.dart",
          "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
          "lib/features/sharing/domain/usecases/send_request_usecase.dart",
          "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
          "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
          "lib/features/sharing/domain/usecases/revoke_sharing_usecase.dart",
          "lib/features/sharing/domain/usecases/get_shared_stats_usecase.dart",
          "lib/features/sharing/domain/usecases/search_users_usecase.dart",
          "lib/features/sharing/presentation/providers/sharing_provider.dart",
          "lib/features/sharing/presentation/providers/sharing_state.dart",
          "lib/features/sharing/presentation/screens/friends_screen.dart",
          "lib/features/sharing/presentation/screens/friend_requests_screen.dart",
          "lib/features/sharing/presentation/screens/search_users_screen.dart",
          "lib/features/sharing/presentation/screens/friend_profile_screen.dart",
          "lib/features/sharing/presentation/widgets/friend_card.dart",
          "lib/features/sharing/presentation/widgets/friend_request_card.dart",
          "lib/features/sharing/presentation/widgets/user_search_result.dart",
          "lib/features/sharing/presentation/widgets/friend_activity_card.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/sharing.routes.ts",
          "project-app-pasos-backend/src/routes/users.routes.ts",
          "project-app-pasos-backend/src/models/SharingRelationship.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-auth-ui",
          "epic-ui-foundation",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Search with debounce using Timer",
          "Status-based filtering (pending, accepted, bidirectional)",
          "API endpoints: GET /api/sharing, POST /api/sharing/request, PUT /api/sharing/:id/accept, PUT /api/sharing/:id/reject, DELETE /api/sharing/:id, GET /api/sharing/:userId/stats"
        ],
        "stories": [
          {
            "id": "story-sharing-domain",
            "title": "Create sharing domain layer",
            "description": "Define SharingRelationship (requesterId, targetId, status, createdAt) and SharedUserStats entities. Create SharingRepository interface and all sharing use cases.",
            "filesToCreate": [
              "lib/features/sharing/domain/entities/sharing_relationship.dart",
              "lib/features/sharing/domain/entities/shared_user_stats.dart",
              "lib/features/sharing/domain/repositories/sharing_repository.dart",
              "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
              "lib/features/sharing/domain/usecases/send_request_usecase.dart",
              "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
              "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
              "lib/features/sharing/domain/usecases/revoke_sharing_usecase.dart",
              "lib/features/sharing/domain/usecases/get_shared_stats_usecase.dart",
              "lib/features/sharing/domain/usecases/search_users_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-data",
            "title": "Implement sharing data layer",
            "description": "Create SharingRelationshipModel and SharedUserStatsModel. Implement SharingRemoteDataSource and SharingRepositoryImpl.",
            "filesToCreate": [
              "lib/features/sharing/data/models/sharing_relationship_model.dart",
              "lib/features/sharing/data/models/shared_user_stats_model.dart",
              "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
              "lib/features/sharing/data/repositories/sharing_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-state",
            "title": "Create sharing state management",
            "description": "Implement SharingState with friends list, pending incoming/outgoing requests, search results. Create SharingNotifier for all sharing operations.",
            "filesToCreate": [
              "lib/features/sharing/presentation/providers/sharing_state.dart",
              "lib/features/sharing/presentation/providers/sharing_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-friends-screen",
            "title": "Build friends list screen",
            "description": "Create FriendsScreen with list of accepted friends showing their username, avatar, and today's steps. Include empty state and FAB for adding friends.",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/friends_screen.dart",
              "lib/features/sharing/presentation/widgets/friend_card.dart",
              "lib/features/sharing/presentation/widgets/friend_activity_card.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-requests-screen",
            "title": "Build friend requests screen",
            "description": "Create FriendRequestsScreen with tabs for incoming/outgoing requests. Show accept/reject buttons for incoming, cancel for outgoing.",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/friend_requests_screen.dart",
              "lib/features/sharing/presentation/widgets/friend_request_card.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-search-screen",
            "title": "Build user search screen",
            "description": "Create SearchUsersScreen with debounced search input (300ms delay), results list showing username and send request button",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/search_users_screen.dart",
              "lib/features/sharing/presentation/widgets/user_search_result.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          },
          {
            "id": "story-friend-profile",
            "title": "Build friend profile screen",
            "description": "Create FriendProfileScreen showing friend's stats, weekly chart, and option to revoke sharing",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/friend_profile_screen.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-goals-ui",
        "title": "Goals UI - Group Goals and Challenges",
        "description": "Build group goals feature with goal creation, member management, progress tracking, leaderboards showing member rankings, and goal invitation handling",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/goals/data/datasources/goals_remote_datasource.dart",
          "lib/features/goals/data/repositories/goals_repository_impl.dart",
          "lib/features/goals/data/models/group_goal_model.dart",
          "lib/features/goals/data/models/goal_member_model.dart",
          "lib/features/goals/data/models/goal_progress_model.dart",
          "lib/features/goals/domain/entities/group_goal.dart",
          "lib/features/goals/domain/entities/goal_member.dart",
          "lib/features/goals/domain/entities/goal_progress.dart",
          "lib/features/goals/domain/repositories/goals_repository.dart",
          "lib/features/goals/domain/usecases/create_goal_usecase.dart",
          "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
          "lib/features/goals/domain/usecases/invite_user_usecase.dart",
          "lib/features/goals/domain/usecases/join_goal_usecase.dart",
          "lib/features/goals/domain/usecases/leave_goal_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart",
          "lib/features/goals/presentation/providers/goals_state.dart",
          "lib/features/goals/presentation/screens/goals_list_screen.dart",
          "lib/features/goals/presentation/screens/goal_detail_screen.dart",
          "lib/features/goals/presentation/screens/create_goal_screen.dart",
          "lib/features/goals/presentation/screens/invite_members_screen.dart",
          "lib/features/goals/presentation/widgets/goal_card.dart",
          "lib/features/goals/presentation/widgets/goal_progress_indicator.dart",
          "lib/features/goals/presentation/widgets/member_ranking_card.dart",
          "lib/features/goals/presentation/widgets/goal_leaderboard.dart",
          "lib/features/goals/presentation/widgets/goal_invitation_card.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/goals.routes.ts",
          "project-app-pasos-backend/src/models/GroupGoal.ts",
          "project-app-pasos-backend/src/models/GroupGoalMembership.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-auth-ui",
          "epic-ui-foundation",
          "epic-sharing-ui",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Date range picker for goal dates",
          "Progress visualization with animated rings",
          "Ranked leaderboard with position indicators",
          "API endpoints: POST /api/goals, GET /api/goals, GET /api/goals/:id, POST /api/goals/:id/invite, PUT /api/goals/:id/join, DELETE /api/goals/:id/leave, GET /api/goals/:id/progress"
        ],
        "stories": [
          {
            "id": "story-goals-domain",
            "title": "Create goals domain layer",
            "description": "Define GroupGoal (title, description, targetSteps, startDate, endDate, creatorId), GoalMember (userId, status, joinedAt), GoalProgress (currentSteps, targetSteps, progressPercentage) entities. Create GoalsRepository and use cases.",
            "filesToCreate": [
              "lib/features/goals/domain/entities/group_goal.dart",
              "lib/features/goals/domain/entities/goal_member.dart",
              "lib/features/goals/domain/entities/goal_progress.dart",
              "lib/features/goals/domain/repositories/goals_repository.dart",
              "lib/features/goals/domain/usecases/create_goal_usecase.dart",
              "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
              "lib/features/goals/domain/usecases/invite_user_usecase.dart",
              "lib/features/goals/domain/usecases/join_goal_usecase.dart",
              "lib/features/goals/domain/usecases/leave_goal_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-data",
            "title": "Implement goals data layer",
            "description": "Create GroupGoalModel, GoalMemberModel, GoalProgressModel with JSON serialization. Implement GoalsRemoteDataSource and GoalsRepositoryImpl.",
            "filesToCreate": [
              "lib/features/goals/data/models/group_goal_model.dart",
              "lib/features/goals/data/models/goal_member_model.dart",
              "lib/features/goals/data/models/goal_progress_model.dart",
              "lib/features/goals/data/datasources/goals_remote_datasource.dart",
              "lib/features/goals/data/repositories/goals_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-state",
            "title": "Create goals state management",
            "description": "Implement GoalsState with userGoals, selectedGoal, pendingInvitations, isLoading, error. Create GoalsNotifier for all goal operations.",
            "filesToCreate": [
              "lib/features/goals/presentation/providers/goals_state.dart",
              "lib/features/goals/presentation/providers/goals_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-list",
            "title": "Build goals list screen",
            "description": "Create GoalsListScreen with tabs for active/completed goals, showing progress indicators. Include pending invitations section with accept/decline actions.",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/goals_list_screen.dart",
              "lib/features/goals/presentation/widgets/goal_card.dart",
              "lib/features/goals/presentation/widgets/goal_invitation_card.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-goal-detail",
            "title": "Build goal detail screen",
            "description": "Create GoalDetailScreen with goal info card, animated progress ring, member leaderboard sorted by contribution, and management actions (invite/leave)",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/goal_detail_screen.dart",
              "lib/features/goals/presentation/widgets/goal_progress_indicator.dart",
              "lib/features/goals/presentation/widgets/goal_leaderboard.dart",
              "lib/features/goals/presentation/widgets/member_ranking_card.dart"
            ],
            "priority": 5,
            "complexity": "complex"
          },
          {
            "id": "story-create-goal",
            "title": "Build create goal screen",
            "description": "Create CreateGoalScreen with form for title (max 100 chars), description (max 500 chars), target steps (min 1), date range picker for start/end dates (end must be after start)",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/create_goal_screen.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          },
          {
            "id": "story-invite-members",
            "title": "Build invite members screen",
            "description": "Create InviteMembersScreen showing accepted friends list with invite/uninvite toggle actions",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/invite_members_screen.dart"
            ],
            "priority": 7,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-native-integration",
        "title": "Native Integration - Health API Step Tracking",
        "description": "Implement native step data integration using health package for HealthKit (iOS) and Google Fit/Health Connect (Android). Handle permission requests, step reading, background sync, and data reconciliation with backend",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/features/dashboard/presentation/providers/dashboard_provider.dart"
        ],
        "filesToCreate": [
          "lib/features/health/data/datasources/health_datasource.dart",
          "lib/features/health/data/repositories/health_repository_impl.dart",
          "lib/features/health/domain/entities/health_step_data.dart",
          "lib/features/health/domain/repositories/health_repository.dart",
          "lib/features/health/domain/usecases/request_permissions_usecase.dart",
          "lib/features/health/domain/usecases/get_today_steps_usecase.dart",
          "lib/features/health/domain/usecases/get_steps_range_usecase.dart",
          "lib/features/health/domain/usecases/sync_steps_usecase.dart",
          "lib/features/health/presentation/providers/health_provider.dart",
          "lib/features/health/presentation/providers/health_state.dart",
          "lib/features/health/presentation/screens/health_setup_screen.dart",
          "lib/features/health/presentation/widgets/permission_request_card.dart",
          "lib/features/health/presentation/widgets/sync_status_indicator.dart",
          "lib/core/services/background_sync_service.dart",
          "lib/core/services/step_sync_manager.dart"
        ],
        "filesToRead": [],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-platform-config",
          "epic-dashboard",
          "epic-dashboard"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "health package for cross-platform health data access",
          "workmanager for background tasks",
          "Platform detection for iOS vs Android specific flows"
        ],
        "stories": [
          {
            "id": "story-health-domain",
            "title": "Create health domain layer",
            "description": "Define HealthStepData entity (steps, startTime, endTime, source). Create HealthRepository interface with methods for requestPermissions, getTodaySteps, getStepsInRange, hasPermissions.",
            "filesToCreate": [
              "lib/features/health/domain/entities/health_step_data.dart",
              "lib/features/health/domain/repositories/health_repository.dart",
              "lib/features/health/domain/usecases/request_permissions_usecase.dart",
              "lib/features/health/domain/usecases/get_today_steps_usecase.dart",
              "lib/features/health/domain/usecases/get_steps_range_usecase.dart",
              "lib/features/health/domain/usecases/sync_steps_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-health-data",
            "title": "Implement health data layer",
            "description": "Create HealthDataSource using health package. Handle HealthFactory initialization, requestAuthorization for HealthDataType.STEPS, getTotalStepsInInterval. Create HealthRepositoryImpl with platform-specific error handling.",
            "filesToCreate": [
              "lib/features/health/data/datasources/health_datasource.dart",
              "lib/features/health/data/repositories/health_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "complex"
          },
          {
            "id": "story-health-state",
            "title": "Create health state management",
            "description": "Implement HealthState with permissionStatus (unknown, granted, denied), syncStatus (idle, syncing, error), lastSyncTime. Create HealthNotifier for health operations.",
            "filesToCreate": [
              "lib/features/health/presentation/providers/health_state.dart",
              "lib/features/health/presentation/providers/health_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-health-setup",
            "title": "Build health setup screen",
            "description": "Create HealthSetupScreen for onboarding users through permission requests. Show platform-specific instructions (HealthKit for iOS, Health Connect for Android). Handle permission denial gracefully.",
            "filesToCreate": [
              "lib/features/health/presentation/screens/health_setup_screen.dart",
              "lib/features/health/presentation/widgets/permission_request_card.dart",
              "lib/features/health/presentation/widgets/sync_status_indicator.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-background-sync",
            "title": "Implement background sync service",
            "description": "Create BackgroundSyncService using workmanager for periodic sync (every 15 minutes). Implement StepSyncManager for reconciling native health data with server using POST /api/steps endpoint with source='native'.",
            "filesToCreate": [
              "lib/core/services/background_sync_service.dart",
              "lib/core/services/step_sync_manager.dart"
            ],
            "priority": 5,
            "complexity": "complex"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-realtime-client",
        "title": "Real-Time Client - WebSocket Integration",
        "description": "Implement WebSocket client using web_socket_channel for real-time step updates and goal progress. Handle connection management, authentication, reconnection with exponential backoff, and event dispatching to relevant providers",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/features/dashboard/presentation/providers/dashboard_provider.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart",
          "lib/features/sharing/presentation/providers/sharing_provider.dart",
          "lib/core/di/injection_container.dart"
        ],
        "filesToCreate": [
          "lib/core/realtime/socket_client.dart",
          "lib/core/realtime/socket_events.dart",
          "lib/core/realtime/socket_manager.dart",
          "lib/core/realtime/reconnection_strategy.dart",
          "lib/core/realtime/event_handlers/steps_event_handler.dart",
          "lib/core/realtime/event_handlers/goals_event_handler.dart",
          "lib/core/realtime/event_handlers/sharing_event_handler.dart",
          "lib/features/notifications/data/datasources/notification_datasource.dart",
          "lib/features/notifications/domain/entities/app_notification.dart",
          "lib/features/notifications/presentation/providers/notification_provider.dart",
          "lib/features/notifications/presentation/widgets/notification_badge.dart",
          "lib/features/notifications/presentation/widgets/notification_list_item.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/socket/types.ts",
          "project-app-pasos-backend/src/socket/index.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-auth-ui",
          "epic-dashboard",
          "epic-sharing-ui",
          "epic-goals-ui",
          "epic-flutter-foundation",
          "epic-dashboard",
          "epic-sharing-ui",
          "epic-goals-ui"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "web_socket_channel for WebSocket communication",
          "socket.io-client-dart for socket.io protocol compatibility",
          "Exponential backoff: 1s, 2s, 4s, 8s, max 30s",
          "Events: steps-updated, sharing:joined, goal-progress, goal:joined, goal:member-joined"
        ],
        "stories": [
          {
            "id": "story-socket-client",
            "title": "Create WebSocket client infrastructure",
            "description": "Implement SocketClient using socket_io_client (for socket.io compatibility). Define SocketEvents constants matching backend: steps-updated, sharing:joined, goal-progress, goal:joined, goal:member-joined, error.",
            "filesToCreate": [
              "lib/core/realtime/socket_client.dart",
              "lib/core/realtime/socket_events.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-socket-manager",
            "title": "Implement socket manager and reconnection",
            "description": "Create SocketManager singleton handling connection lifecycle (connect on login, disconnect on logout). Implement ReconnectionStrategy with exponential backoff (1s, 2s, 4s, 8s, max 30s) and max 10 retries.",
            "filesToCreate": [
              "lib/core/realtime/socket_manager.dart",
              "lib/core/realtime/reconnection_strategy.dart"
            ],
            "priority": 2,
            "complexity": "complex"
          },
          {
            "id": "story-event-handlers",
            "title": "Create event handlers",
            "description": "Implement StepsEventHandler for steps-updated (userId, steps, timestamp), GoalsEventHandler for goal-progress and goal:member-joined, SharingEventHandler for sharing:joined events.",
            "filesToCreate": [
              "lib/core/realtime/event_handlers/steps_event_handler.dart",
              "lib/core/realtime/event_handlers/goals_event_handler.dart",
              "lib/core/realtime/event_handlers/sharing_event_handler.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-provider-integration",
            "title": "Integrate socket events with providers",
            "description": "Update DashboardProvider to listen for steps-updated and refresh data, GoalsProvider for goal-progress, SharingProvider for sharing:joined. Register SocketManager in injection_container.",
            "filesToModify": [
              "lib/features/dashboard/presentation/providers/dashboard_provider.dart",
              "lib/features/goals/presentation/providers/goals_provider.dart",
              "lib/features/sharing/presentation/providers/sharing_provider.dart",
              "lib/core/di/injection_container.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-notifications",
            "title": "Build notification system",
            "description": "Create AppNotification entity (type, title, body, timestamp). Implement NotificationProvider for in-app notifications triggered by socket events. Build NotificationBadge and NotificationListItem widgets.",
            "filesToCreate": [
              "lib/features/notifications/domain/entities/app_notification.dart",
              "lib/features/notifications/data/datasources/notification_datasource.dart",
              "lib/features/notifications/presentation/providers/notification_provider.dart",
              "lib/features/notifications/presentation/widgets/notification_badge.dart",
              "lib/features/notifications/presentation/widgets/notification_list_item.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      }
    ]
  }
}