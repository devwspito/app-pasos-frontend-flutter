{
  "_metadata": {
    "agentType": "planning",
    "taskId": "3f0a828b1148d7e196359207",
    "timestamp": "2026-01-28T11:14:47.891Z",
    "phase": "planning",
    "savedAt": "2026-01-28T11:14:47.891Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "FNNNN1444",
    "taskDescription": "Descripción de tareas para completar el frontend en Flutter\n\nCompletar los 6 epics del frontend de la aplicación \"Pasos\" (contador de pasos social) usando Flutter.\n\n================================================================================\n\nCONTEXTO\n\n================================================================================\n\nEl backend ya está completo en: project-app-pasos-backend\n\nUsar Flutter para aplicación móvil nativa multiplataforma (iOS/Android/web)\n\n================================================================================\n\nEPICS A IMPLEMENTAR\n\n================================================================================\n\nSHARING UI\n\nLista de amigos\n\nGestión de compartir datos con amigos\n\nSolicitudes de amistad\n\nVista de actividad de amigos\n\nGOALS UI\n\nGrupos y metas compartidas\n\nCreación y edición de metas\n\nProgreso de grupos\n\nRankings\n\nNATIVE INTEGRATION\n\nIntegración con podómetro nativo usando health package\n\nLectura de pasos desde HealthKit (iOS)\n\nLectura de pasos desde Google Fit/Health Connect (Android)\n\nBackground sync de datos\n\nREAL-TIME CLIENT\n\nIntegración WebSocket con web_socket_channel\n\nActualizaciones en tiempo real\n\nNotificaciones push (firebase_messaging)",
    "epicsCount": 4,
    "epics": [
      {
        "id": "epic-native-integration",
        "title": "Native Health Integration",
        "description": "Implement native pedometer integration using the health package to read steps from HealthKit (iOS) and Health Connect (Android). Create HealthService abstraction, handle platform permissions, and integrate with dashboard for automatic step recording.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
          "lib/features/dashboard/presentation/pages/dashboard_page.dart",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/core/health/health_service.dart",
          "lib/core/health/health_service_impl.dart",
          "lib/core/health/health_permissions_handler.dart",
          "lib/features/dashboard/domain/usecases/sync_native_steps_usecase.dart",
          "lib/features/dashboard/presentation/widgets/health_permission_card.dart",
          "lib/features/dashboard/presentation/widgets/step_source_indicator.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart",
          "lib/features/dashboard/domain/repositories/steps_repository.dart",
          "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Clean Architecture with domain/data/presentation layers",
          "Dependency injection via get_it",
          "Abstract interface in core/, implementation separate",
          "BLoC event handling pattern"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-realtime-client",
        "title": "Real-time WebSocket Client",
        "description": "Implement WebSocket client using web_socket_channel to connect with the backend Socket.io server. Handle authentication, automatic reconnection, and dispatch real-time events (steps-updated, goal-progress, sharing:joined) to update existing BLoCs.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/sharing/presentation/bloc/sharing_event.dart",
          "lib/features/sharing/presentation/bloc/sharing_state.dart",
          "lib/features/goals/presentation/bloc/goal_detail_bloc.dart",
          "lib/features/goals/presentation/bloc/goal_detail_event.dart",
          "lib/app.dart",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/core/realtime/websocket_service.dart",
          "lib/core/realtime/websocket_service_impl.dart",
          "lib/core/realtime/realtime_events.dart",
          "lib/core/realtime/connection_state.dart",
          "lib/features/sharing/presentation/widgets/realtime_status_indicator.dart"
        ],
        "filesToRead": [
          "lib/core/storage/secure_storage_service.dart",
          "lib/core/network/api_endpoints.dart",
          "lib/features/sharing/presentation/pages/friends_list_page.dart",
          "lib/features/goals/presentation/pages/goal_detail_page.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-native-integration"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Service abstraction pattern matching ApiClient",
          "Stream-based reactive updates",
          "Token retrieval from SecureStorageService",
          "Event dispatching to BLoC"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-background-sync",
        "title": "Background Step Synchronization",
        "description": "Implement background service to periodically sync native steps to the backend even when the app is not in foreground. Use workmanager for periodic tasks and ensure steps are recorded with proper timestamps.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart",
          "lib/core/di/injection_container.dart",
          "pubspec.yaml",
          "android/app/src/main/AndroidManifest.xml"
        ],
        "filesToCreate": [
          "lib/core/background/background_sync_service.dart",
          "lib/core/background/background_sync_callback.dart",
          "lib/core/background/sync_task_handler.dart",
          "lib/core/storage/local_step_cache.dart"
        ],
        "filesToRead": [
          "lib/core/health/health_service.dart",
          "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-native-integration",
          "epic-native-integration"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Callback isolation for background execution",
          "Local caching for offline resilience",
          "Dependency injection for testability"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-push-notifications",
        "title": "Push Notifications with Firebase",
        "description": "Implement push notifications using firebase_messaging to receive friend request notifications, goal invitations, and goal completion alerts. Handle notification permissions, foreground/background message handling, and deep linking to relevant screens.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart",
          "lib/core/di/injection_container.dart",
          "lib/core/router/app_router.dart",
          "pubspec.yaml",
          "android/app/build.gradle",
          "ios/Runner/AppDelegate.swift"
        ],
        "filesToCreate": [
          "lib/core/notifications/notification_service.dart",
          "lib/core/notifications/notification_service_impl.dart",
          "lib/core/notifications/notification_handler.dart",
          "lib/core/notifications/notification_types.dart",
          "android/app/google-services.json",
          "ios/Runner/GoogleService-Info.plist",
          "ios/firebase_app_id_file.json"
        ],
        "filesToRead": [
          "lib/core/router/route_names.dart",
          "lib/features/sharing/presentation/pages/friend_requests_page.dart",
          "lib/features/goals/presentation/pages/goal_detail_page.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-realtime-client",
          "epic-native-integration",
          "epic-background-sync"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "Service abstraction pattern",
          "Deep linking via GoRouter",
          "Permission handling pattern from health integration"
        ],
        "repoType": "frontend"
      }
    ]
  }
}