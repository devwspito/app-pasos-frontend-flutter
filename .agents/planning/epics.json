{
  "_metadata": {
    "agentType": "planning",
    "taskId": "79156fab43a45da56beb3069",
    "timestamp": "2026-01-27T13:45:48.449Z",
    "phase": "planning",
    "savedAt": "2026-01-27T13:45:48.449Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "FN12NM",
    "taskDescription": "Descripción de tareas para completar el frontend en Flutter\n\nCompletar los 7 epics del frontend de la aplicación \"Pasos\" (contador de pasos social) usando Flutter.\n\n================================================================================\n\nCONTEXTO\n\n================================================================================\n\nEl backend ya está completo en: project-app-pasos-backend\n\nUsar Flutter para aplicación móvil nativa multiplataforma (iOS/Android/web)\n\n================================================================================\n\nEPICS A IMPLEMENTAR\n\n================================================================================\n\nDASHBOARD\n\nVista principal con contador de pasos\n\nHistorial de actividad\n\nGráficos (fl_chart o charts_flutter)\n\nPull-to-refresh\n\nSHARING UI\n\nLista de amigos\n\nGestión de compartir datos con amigos\n\nSolicitudes de amistad\n\nVista de actividad de amigos\n\nGOALS UI\n\nGrupos y metas compartidas\n\nCreación y edición de metas\n\nProgreso de grupos\n\nRankings\n\nNATIVE INTEGRATION\n\nIntegración con podómetro nativo usando health package\n\nLectura de pasos desde HealthKit (iOS)\n\nLectura de pasos desde Google Fit/Health Connect (Android)\n\nBackground sync de datos\n\nREAL-TIME CLIENT\n\nIntegración WebSocket con web_socket_channel\n\nActualizaciones en tiempo real\n\nNotificaciones push (firebase_messaging)\n\nManejo de reconexión",
    "epicsCount": 5,
    "epics": [
      {
        "id": "epic-dashboard",
        "title": "Dashboard - Step Counter UI with Charts",
        "description": "Implement the main dashboard view showing step counter, activity history, and trend charts. Includes pull-to-refresh, daily/weekly/monthly statistics, and hourly peak visualization using fl_chart.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart",
          "lib/core/network/api_endpoints.dart",
          "lib/pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/features/dashboard/domain/entities/step_record.dart",
          "lib/features/dashboard/domain/entities/step_stats.dart",
          "lib/features/dashboard/domain/entities/weekly_trend.dart",
          "lib/features/dashboard/domain/entities/hourly_peak.dart",
          "lib/features/dashboard/domain/repositories/steps_repository.dart",
          "lib/features/dashboard/domain/usecases/get_today_steps_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_weekly_trend_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_stats_usecase.dart",
          "lib/features/dashboard/domain/usecases/get_hourly_peaks_usecase.dart",
          "lib/features/dashboard/domain/usecases/record_steps_usecase.dart",
          "lib/features/dashboard/data/models/step_record_model.dart",
          "lib/features/dashboard/data/models/step_stats_model.dart",
          "lib/features/dashboard/data/models/weekly_trend_model.dart",
          "lib/features/dashboard/data/models/hourly_peak_model.dart",
          "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
          "lib/features/dashboard/data/repositories/steps_repository_impl.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_state.dart",
          "lib/features/dashboard/presentation/pages/dashboard_page.dart",
          "lib/features/dashboard/presentation/widgets/step_counter_card.dart",
          "lib/features/dashboard/presentation/widgets/stats_overview_card.dart",
          "lib/features/dashboard/presentation/widgets/weekly_chart.dart",
          "lib/features/dashboard/presentation/widgets/hourly_chart.dart",
          "lib/features/dashboard/presentation/widgets/activity_history_list.dart"
        ],
        "filesToRead": [
          "lib/features/auth/data/repositories/auth_repository_impl.dart",
          "lib/features/auth/presentation/bloc/auth_bloc.dart",
          "lib/shared/widgets/app_card.dart",
          "project-app-pasos-backend/src/routes/steps.routes.ts",
          "project-app-pasos-backend/src/services/steps.service.ts"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Clean Architecture with domain/data/presentation layers",
          "BLoC pattern matching AuthBloc structure",
          "Repository pattern matching AuthRepositoryImpl",
          "DI registration in injection_container.dart"
        ],
        "stories": [
          {
            "id": "story-dashboard-001",
            "title": "Create Steps Domain Layer",
            "description": "Implement domain entities (StepRecord, StepStats, WeeklyTrend, HourlyPeak), repository interface, and use cases for steps operations",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/dashboard/domain/entities/step_record.dart",
              "lib/features/dashboard/domain/entities/step_stats.dart",
              "lib/features/dashboard/domain/entities/weekly_trend.dart",
              "lib/features/dashboard/domain/entities/hourly_peak.dart",
              "lib/features/dashboard/domain/repositories/steps_repository.dart",
              "lib/features/dashboard/domain/usecases/get_today_steps_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_weekly_trend_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_stats_usecase.dart",
              "lib/features/dashboard/domain/usecases/get_hourly_peaks_usecase.dart",
              "lib/features/dashboard/domain/usecases/record_steps_usecase.dart"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-dashboard-002",
            "title": "Create Steps Data Layer",
            "description": "Implement data models, remote datasource for API calls, and repository implementation",
            "filesToModify": [
              "lib/core/network/api_endpoints.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/data/models/step_record_model.dart",
              "lib/features/dashboard/data/models/step_stats_model.dart",
              "lib/features/dashboard/data/models/weekly_trend_model.dart",
              "lib/features/dashboard/data/models/hourly_peak_model.dart",
              "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
              "lib/features/dashboard/data/repositories/steps_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "simple"
          },
          {
            "id": "story-dashboard-003",
            "title": "Create Dashboard BLoC",
            "description": "Implement DashboardBloc with events and states for managing dashboard data, including loading, success, and error states",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
              "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
              "lib/features/dashboard/presentation/bloc/dashboard_state.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-dashboard-004",
            "title": "Create Dashboard Page and Step Counter",
            "description": "Implement main dashboard page with step counter card showing today's steps with circular progress indicator",
            "filesToModify": [
              "lib/core/router/app_router.dart",
              "lib/core/router/route_names.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/presentation/pages/dashboard_page.dart",
              "lib/features/dashboard/presentation/widgets/step_counter_card.dart",
              "lib/features/dashboard/presentation/widgets/stats_overview_card.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-dashboard-005",
            "title": "Implement Charts with fl_chart",
            "description": "Add weekly trend line chart and hourly distribution bar chart using fl_chart package",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "filesToCreate": [
              "lib/features/dashboard/presentation/widgets/weekly_chart.dart",
              "lib/features/dashboard/presentation/widgets/hourly_chart.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-006",
            "title": "Add Activity History and Pull-to-Refresh",
            "description": "Implement activity history list and pull-to-refresh functionality on dashboard",
            "filesToModify": [
              "lib/features/dashboard/presentation/pages/dashboard_page.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/presentation/widgets/activity_history_list.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-sharing",
        "title": "Sharing UI - Friends and Data Sharing",
        "description": "Implement the sharing feature allowing users to add friends, manage sharing relationships, view pending requests, and see friends' step activity.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart",
          "lib/core/network/api_endpoints.dart"
        ],
        "filesToCreate": [
          "lib/features/sharing/domain/entities/sharing_relationship.dart",
          "lib/features/sharing/domain/entities/friend_stats.dart",
          "lib/features/sharing/domain/repositories/sharing_repository.dart",
          "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
          "lib/features/sharing/domain/usecases/send_request_usecase.dart",
          "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
          "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
          "lib/features/sharing/domain/usecases/revoke_sharing_usecase.dart",
          "lib/features/sharing/domain/usecases/get_friend_stats_usecase.dart",
          "lib/features/sharing/data/models/sharing_relationship_model.dart",
          "lib/features/sharing/data/models/friend_stats_model.dart",
          "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
          "lib/features/sharing/data/repositories/sharing_repository_impl.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/sharing/presentation/bloc/sharing_event.dart",
          "lib/features/sharing/presentation/bloc/sharing_state.dart",
          "lib/features/sharing/presentation/pages/friends_page.dart",
          "lib/features/sharing/presentation/pages/friend_requests_page.dart",
          "lib/features/sharing/presentation/pages/friend_detail_page.dart",
          "lib/features/sharing/presentation/widgets/friend_list_item.dart",
          "lib/features/sharing/presentation/widgets/friend_request_card.dart",
          "lib/features/sharing/presentation/widgets/add_friend_dialog.dart",
          "lib/features/sharing/presentation/widgets/friend_activity_card.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/sharing.routes.ts",
          "project-app-pasos-backend/src/models/SharingRelationship.ts",
          "project-app-pasos-backend/src/controllers/sharing.controller.ts"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-dashboard",
          "epic-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean Architecture layers",
          "BLoC state management",
          "Repository pattern",
          "Use case per operation"
        ],
        "stories": [
          {
            "id": "story-sharing-001",
            "title": "Create Sharing Domain Layer",
            "description": "Implement SharingRelationship and FriendStats entities, repository interface, and use cases for all sharing operations",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/sharing/domain/entities/sharing_relationship.dart",
              "lib/features/sharing/domain/entities/friend_stats.dart",
              "lib/features/sharing/domain/repositories/sharing_repository.dart",
              "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
              "lib/features/sharing/domain/usecases/send_request_usecase.dart",
              "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
              "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
              "lib/features/sharing/domain/usecases/revoke_sharing_usecase.dart",
              "lib/features/sharing/domain/usecases/get_friend_stats_usecase.dart"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-002",
            "title": "Create Sharing Data Layer",
            "description": "Implement data models, remote datasource for sharing API, and repository implementation",
            "filesToModify": [
              "lib/core/network/api_endpoints.dart"
            ],
            "filesToCreate": [
              "lib/features/sharing/data/models/sharing_relationship_model.dart",
              "lib/features/sharing/data/models/friend_stats_model.dart",
              "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
              "lib/features/sharing/data/repositories/sharing_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-003",
            "title": "Create Sharing BLoC",
            "description": "Implement SharingBloc with events and states for managing friends list, requests, and sharing operations",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
              "lib/features/sharing/presentation/bloc/sharing_event.dart",
              "lib/features/sharing/presentation/bloc/sharing_state.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-004",
            "title": "Create Friends List Page",
            "description": "Implement main friends page showing list of active sharing relationships with friend activity preview",
            "filesToModify": [
              "lib/core/router/app_router.dart",
              "lib/core/router/route_names.dart"
            ],
            "filesToCreate": [
              "lib/features/sharing/presentation/pages/friends_page.dart",
              "lib/features/sharing/presentation/widgets/friend_list_item.dart",
              "lib/features/sharing/presentation/widgets/friend_activity_card.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-005",
            "title": "Create Friend Requests Page",
            "description": "Implement page for viewing and managing incoming/outgoing friend requests",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/sharing/presentation/pages/friend_requests_page.dart",
              "lib/features/sharing/presentation/widgets/friend_request_card.dart"
            ],
            "priority": 5,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-006",
            "title": "Create Add Friend and Detail Pages",
            "description": "Implement add friend dialog with user search and friend detail page showing their stats",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/sharing/presentation/widgets/add_friend_dialog.dart",
              "lib/features/sharing/presentation/pages/friend_detail_page.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-goals",
        "title": "Goals UI - Group Goals and Rankings",
        "description": "Implement group goals feature allowing users to create shared goals, invite members, track collective progress, and view rankings/leaderboards.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart",
          "lib/core/network/api_endpoints.dart"
        ],
        "filesToCreate": [
          "lib/features/goals/domain/entities/group_goal.dart",
          "lib/features/goals/domain/entities/goal_member.dart",
          "lib/features/goals/domain/entities/goal_progress.dart",
          "lib/features/goals/domain/repositories/goals_repository.dart",
          "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
          "lib/features/goals/domain/usecases/create_goal_usecase.dart",
          "lib/features/goals/domain/usecases/invite_user_usecase.dart",
          "lib/features/goals/domain/usecases/join_goal_usecase.dart",
          "lib/features/goals/domain/usecases/leave_goal_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart",
          "lib/features/goals/data/models/group_goal_model.dart",
          "lib/features/goals/data/models/goal_member_model.dart",
          "lib/features/goals/data/models/goal_progress_model.dart",
          "lib/features/goals/data/datasources/goals_remote_datasource.dart",
          "lib/features/goals/data/repositories/goals_repository_impl.dart",
          "lib/features/goals/presentation/bloc/goals_bloc.dart",
          "lib/features/goals/presentation/bloc/goals_event.dart",
          "lib/features/goals/presentation/bloc/goals_state.dart",
          "lib/features/goals/presentation/pages/goals_list_page.dart",
          "lib/features/goals/presentation/pages/goal_detail_page.dart",
          "lib/features/goals/presentation/pages/create_goal_page.dart",
          "lib/features/goals/presentation/widgets/goal_card.dart",
          "lib/features/goals/presentation/widgets/goal_progress_indicator.dart",
          "lib/features/goals/presentation/widgets/member_ranking_list.dart",
          "lib/features/goals/presentation/widgets/invite_member_dialog.dart",
          "lib/features/goals/presentation/widgets/goal_form.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/routes/goals.routes.ts",
          "project-app-pasos-backend/src/models/GroupGoal.ts",
          "project-app-pasos-backend/src/models/GroupGoalMembership.ts",
          "project-app-pasos-backend/src/services/goals.service.ts"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-dashboard",
          "epic-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean Architecture layers",
          "BLoC state management",
          "Form validation with Validators class",
          "Repository pattern"
        ],
        "stories": [
          {
            "id": "story-goals-001",
            "title": "Create Goals Domain Layer",
            "description": "Implement GroupGoal, GoalMember, GoalProgress entities, repository interface, and all goal-related use cases",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/goals/domain/entities/group_goal.dart",
              "lib/features/goals/domain/entities/goal_member.dart",
              "lib/features/goals/domain/entities/goal_progress.dart",
              "lib/features/goals/domain/repositories/goals_repository.dart",
              "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
              "lib/features/goals/domain/usecases/create_goal_usecase.dart",
              "lib/features/goals/domain/usecases/invite_user_usecase.dart",
              "lib/features/goals/domain/usecases/join_goal_usecase.dart",
              "lib/features/goals/domain/usecases/leave_goal_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-goals-002",
            "title": "Create Goals Data Layer",
            "description": "Implement data models, remote datasource for goals API, and repository implementation",
            "filesToModify": [
              "lib/core/network/api_endpoints.dart"
            ],
            "filesToCreate": [
              "lib/features/goals/data/models/group_goal_model.dart",
              "lib/features/goals/data/models/goal_member_model.dart",
              "lib/features/goals/data/models/goal_progress_model.dart",
              "lib/features/goals/data/datasources/goals_remote_datasource.dart",
              "lib/features/goals/data/repositories/goals_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "simple"
          },
          {
            "id": "story-goals-003",
            "title": "Create Goals BLoC",
            "description": "Implement GoalsBloc with events and states for managing goals list, details, creation, and membership",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/features/goals/presentation/bloc/goals_bloc.dart",
              "lib/features/goals/presentation/bloc/goals_event.dart",
              "lib/features/goals/presentation/bloc/goals_state.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-goals-004",
            "title": "Create Goals List Page",
            "description": "Implement main goals page showing user's active and past goals with progress overview",
            "filesToModify": [
              "lib/core/router/app_router.dart",
              "lib/core/router/route_names.dart"
            ],
            "filesToCreate": [
              "lib/features/goals/presentation/pages/goals_list_page.dart",
              "lib/features/goals/presentation/widgets/goal_card.dart",
              "lib/features/goals/presentation/widgets/goal_progress_indicator.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-goals-005",
            "title": "Create Goal Detail and Rankings Page",
            "description": "Implement goal detail page with member list, progress tracking, and rankings/leaderboard",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/goals/presentation/pages/goal_detail_page.dart",
              "lib/features/goals/presentation/widgets/member_ranking_list.dart",
              "lib/features/goals/presentation/widgets/invite_member_dialog.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-006",
            "title": "Create Goal Form Page",
            "description": "Implement create/edit goal page with form validation for title, target steps, and date range",
            "filesToModify": [],
            "filesToCreate": [
              "lib/features/goals/presentation/pages/create_goal_page.dart",
              "lib/features/goals/presentation/widgets/goal_form.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-native-integration",
        "title": "Native Integration - Health Package Pedometer",
        "description": "Implement native pedometer integration using health package to read step data from HealthKit (iOS) and Google Fit/Health Connect (Android), with background sync capability.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_state.dart",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist"
        ],
        "filesToCreate": [
          "lib/core/services/health_service.dart",
          "lib/core/services/background_sync_service.dart",
          "lib/features/dashboard/domain/usecases/sync_native_steps_usecase.dart",
          "lib/features/dashboard/presentation/widgets/health_permission_dialog.dart",
          "lib/features/dashboard/presentation/widgets/sync_status_indicator.dart"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/models/Step.ts",
          "project-app-pasos-backend/src/routes/steps.routes.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-dashboard",
          "epic-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Service class for platform integration",
          "Use case for business logic",
          "Permission handling with dialogs",
          "Background service registration"
        ],
        "stories": [
          {
            "id": "story-native-001",
            "title": "Add Health Package Dependencies",
            "description": "Add health package to pubspec.yaml and configure iOS/Android permissions in Info.plist and AndroidManifest.xml",
            "filesToModify": [
              "pubspec.yaml",
              "android/app/src/main/AndroidManifest.xml",
              "ios/Runner/Info.plist"
            ],
            "filesToCreate": [],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-native-002",
            "title": "Create Health Service",
            "description": "Implement HealthService class that abstracts health package for reading steps from HealthKit and Google Fit with permission handling",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/core/services/health_service.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-native-003",
            "title": "Create Sync Native Steps Use Case",
            "description": "Implement use case that reads native steps and syncs to backend API",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/domain/usecases/sync_native_steps_usecase.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-native-004",
            "title": "Create Health Permission UI",
            "description": "Implement permission request dialog and sync status indicator widget",
            "filesToModify": [
              "lib/features/dashboard/presentation/pages/dashboard_page.dart"
            ],
            "filesToCreate": [
              "lib/features/dashboard/presentation/widgets/health_permission_dialog.dart",
              "lib/features/dashboard/presentation/widgets/sync_status_indicator.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-native-005",
            "title": "Integrate with Dashboard BLoC",
            "description": "Add native step sync events and states to DashboardBloc, trigger sync on dashboard load",
            "filesToModify": [
              "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
              "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
              "lib/features/dashboard/presentation/bloc/dashboard_state.dart"
            ],
            "filesToCreate": [],
            "priority": 5,
            "complexity": "simple"
          },
          {
            "id": "story-native-006",
            "title": "Implement Background Sync Service",
            "description": "Create background sync service for periodic step data synchronization when app is not active",
            "filesToModify": [
              "lib/core/di/injection_container.dart",
              "lib/main.dart"
            ],
            "filesToCreate": [
              "lib/core/services/background_sync_service.dart"
            ],
            "priority": 6,
            "complexity": "complex"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-realtime",
        "title": "Real-time Client - WebSocket and Push Notifications",
        "description": "Implement WebSocket client for real-time step updates and goal progress, plus Firebase Cloud Messaging for push notifications about friend activity and goal achievements.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/goals/presentation/bloc/goals_bloc.dart",
          "android/app/build.gradle",
          "ios/Runner/Info.plist",
          "lib/main.dart"
        ],
        "filesToCreate": [
          "lib/core/services/websocket_service.dart",
          "lib/core/services/push_notification_service.dart",
          "lib/core/services/notification_handler.dart",
          "lib/features/realtime/domain/entities/realtime_event.dart",
          "lib/features/realtime/presentation/bloc/realtime_bloc.dart",
          "lib/features/realtime/presentation/bloc/realtime_event.dart",
          "lib/features/realtime/presentation/bloc/realtime_state.dart",
          "lib/features/realtime/presentation/widgets/connection_status_badge.dart",
          "android/app/google-services.json",
          "ios/Runner/GoogleService-Info.plist",
          "firebase.json"
        ],
        "filesToRead": [
          "project-app-pasos-backend/src/socket/types.ts",
          "project-app-pasos-backend/src/socket/index.ts",
          "project-app-pasos-backend/src/socket/handlers/sharing.handler.ts",
          "project-app-pasos-backend/src/socket/handlers/goals.handler.ts"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-dashboard",
          "epic-sharing",
          "epic-goals",
          "epic-dashboard",
          "epic-sharing",
          "epic-goals",
          "epic-native-integration"
        ],
        "executionOrder": 4,
        "followsPatterns": [
          "Service class for WebSocket management",
          "BLoC for connection state",
          "Event-driven architecture matching backend socket events",
          "Firebase configuration"
        ],
        "stories": [
          {
            "id": "story-realtime-001",
            "title": "Add WebSocket and Firebase Dependencies",
            "description": "Add web_socket_channel, firebase_messaging, firebase_core to pubspec.yaml",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "filesToCreate": [],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-realtime-002",
            "title": "Create WebSocket Service",
            "description": "Implement WebSocketService with connection management, authentication, reconnection logic, and event streaming",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/core/services/websocket_service.dart",
              "lib/features/realtime/domain/entities/realtime_event.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-003",
            "title": "Create Realtime BLoC",
            "description": "Implement RealtimeBloc for managing WebSocket connection state and distributing events to feature BLoCs",
            "filesToModify": [
              "lib/core/di/injection_container.dart"
            ],
            "filesToCreate": [
              "lib/features/realtime/presentation/bloc/realtime_bloc.dart",
              "lib/features/realtime/presentation/bloc/realtime_event.dart",
              "lib/features/realtime/presentation/bloc/realtime_state.dart",
              "lib/features/realtime/presentation/widgets/connection_status_badge.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-004",
            "title": "Integrate Real-time with Feature BLoCs",
            "description": "Connect WebSocket events to Dashboard, Sharing, and Goals BLoCs for live updates",
            "filesToModify": [
              "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
              "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
              "lib/features/goals/presentation/bloc/goals_bloc.dart"
            ],
            "filesToCreate": [],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-005",
            "title": "Configure Firebase Project",
            "description": "Set up Firebase project, add google-services.json and GoogleService-Info.plist, configure build.gradle and Info.plist",
            "filesToModify": [
              "android/app/build.gradle",
              "ios/Runner/Info.plist"
            ],
            "filesToCreate": [
              "android/app/google-services.json",
              "ios/Runner/GoogleService-Info.plist",
              "firebase.json"
            ],
            "priority": 5,
            "complexity": "simple"
          },
          {
            "id": "story-realtime-006",
            "title": "Create Push Notification Service",
            "description": "Implement PushNotificationService for FCM token management, notification handling, and local notification display",
            "filesToModify": [
              "lib/core/di/injection_container.dart",
              "lib/main.dart"
            ],
            "filesToCreate": [
              "lib/core/services/push_notification_service.dart",
              "lib/core/services/notification_handler.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      }
    ]
  }
}