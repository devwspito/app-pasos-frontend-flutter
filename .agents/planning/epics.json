{
  "_metadata": {
    "agentType": "planning",
    "taskId": "755214819d2c213608fe0167",
    "timestamp": "2026-01-29T16:32:30.332Z",
    "phase": "planning",
    "savedAt": "2026-01-29T16:32:30.332Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "FNN213",
    "taskDescription": "Descripción de tareas para completar el frontend en Flutter\n\nCompletar los del frontend de la aplicación \"Pasos\" (contador de pasos social) usando Flutter.\n\n================================================================================\n\nCONTEXTO\n\n================================================================================\n\nEl backend ya está completo en: project-app-pasos-backend\n\nUsar Flutter para aplicación móvil nativa multiplataforma (iOS/Android/web)\n\n================================================================================\n\nEPICS A IMPLEMENTAR\n\n================================================================================\n\nSHARING UI\n\nLista de amigos\n\nGestión de compartir datos con amigos\n\nSolicitudes de amistad\n\nVista de actividad de amigos\n\nGOALS UI\n\nGrupos y metas compartidas\n\nCreación y edición de metas\n\nProgreso de grupos\n\nRankings\n\nNATIVE INTEGRATION\n\nIntegración con podómetro nativo usando health package\n\nLectura de pasos desde HealthKit (iOS)\n\nLectura de pasos desde Google Fit/Health Connect (Android)\n\nBackground sync de datos\n\nREAL-TIME CLIENT\n\nIntegración WebSocket con web_socket_channel\n\nActualizaciones en tiempo real\n\nNotificaciones push (firebase_messaging)",
    "epicsCount": 6,
    "epics": [
      {
        "id": "epic-native-health",
        "title": "Native Health Integration",
        "description": "Integrate with native health APIs (HealthKit on iOS, Google Fit/Health Connect on Android) to read step data from device sensors. Implement a HealthService abstraction that provides cross-platform step reading and permissions handling.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_bloc.dart",
          "lib/features/dashboard/presentation/bloc/dashboard_event.dart",
          "lib/features/dashboard/presentation/pages/dashboard_page.dart",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/core/services/health_service.dart",
          "lib/core/services/health_service_impl.dart",
          "lib/features/dashboard/domain/usecases/sync_native_steps_usecase.dart",
          "lib/features/dashboard/presentation/widgets/health_permission_dialog.dart",
          "lib/features/dashboard/presentation/widgets/step_source_indicator.dart"
        ],
        "filesToRead": [
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/data/datasources/steps_remote_datasource.dart",
          "lib/features/dashboard/domain/repositories/steps_repository.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Uses existing DI pattern with get_it",
          "Follows Clean Architecture with service abstraction",
          "Integrates with existing DashboardBloc"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-background-sync",
        "title": "Background Step Sync",
        "description": "Implement background synchronization to periodically read native step data and upload to backend. Uses workmanager package for Android and background_fetch for iOS to ensure steps are recorded even when app is not active.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart",
          "lib/core/di/injection_container.dart",
          "lib/features/dashboard/data/repositories/steps_repository_impl.dart",
          "pubspec.yaml",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist"
        ],
        "filesToCreate": [
          "lib/core/services/background_sync_service.dart",
          "lib/core/services/background_sync_service_impl.dart",
          "lib/core/workers/step_sync_worker.dart"
        ],
        "filesToRead": [
          "lib/main.dart",
          "lib/features/dashboard/domain/usecases/record_steps_usecase.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-native-health",
          "epic-native-health"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Service abstraction pattern",
          "Uses existing RecordStepsUseCase for upload",
          "Configures native permissions properly"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-websocket-realtime",
        "title": "Real-time WebSocket Client",
        "description": "Implement WebSocket service using web_socket_channel to connect to backend Socket.io server. Handle connection lifecycle, automatic reconnection, and event dispatching to relevant BLoCs for real-time UI updates of friend steps and goal progress.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/core/network/api_endpoints.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/sharing/presentation/bloc/sharing_event.dart",
          "lib/features/sharing/presentation/bloc/sharing_state.dart",
          "lib/features/goals/presentation/bloc/goal_detail_bloc.dart",
          "lib/features/goals/presentation/bloc/goal_detail_event.dart",
          "lib/features/goals/presentation/bloc/goal_detail_state.dart",
          "lib/app.dart",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/core/services/websocket_service.dart",
          "lib/core/services/websocket_service_impl.dart",
          "lib/core/services/websocket_event_handler.dart",
          "lib/features/sharing/domain/entities/realtime_step_update.dart",
          "lib/features/goals/domain/entities/realtime_goal_update.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/goals/presentation/bloc/goal_detail_bloc.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-native-health"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Service abstraction with interface",
          "Integrates with existing BLoC event system",
          "Uses SecureStorageService for auth token"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-push-notifications",
        "title": "Push Notifications Integration",
        "description": "Integrate Firebase Cloud Messaging for push notifications. Handle notifications for friend requests, friend request acceptance, goal invitations, and goal completion milestones. Implement notification handling both in foreground and background.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart",
          "lib/core/di/injection_container.dart",
          "lib/core/router/app_router.dart",
          "lib/app.dart",
          "pubspec.yaml",
          "android/app/build.gradle",
          "android/build.gradle",
          "ios/Runner/AppDelegate.swift"
        ],
        "filesToCreate": [
          "lib/core/services/notification_service.dart",
          "lib/core/services/notification_service_impl.dart",
          "lib/core/services/notification_handler.dart",
          "android/app/google-services.json",
          "ios/Runner/GoogleService-Info.plist",
          "ios/firebase_app_id_file.json"
        ],
        "filesToRead": [
          "lib/main.dart",
          "lib/core/router/app_router.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-native-health",
          "epic-background-sync",
          "epic-websocket-realtime"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "Service abstraction pattern",
          "Uses GoRouter for deep link navigation",
          "Follows Firebase initialization best practices"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-sharing-ui-enhancement",
        "title": "Sharing UI Enhancement",
        "description": "Enhance existing Sharing UI to display actual user data (names, avatars) instead of placeholder text. Improve friend card display, add loading states for real-time updates, and implement visual indicators for online status.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/features/sharing/presentation/pages/friends_list_page.dart",
          "lib/features/sharing/presentation/pages/friend_activity_page.dart",
          "lib/features/sharing/presentation/widgets/friend_card.dart",
          "lib/features/sharing/presentation/widgets/friend_stats_card.dart",
          "lib/features/sharing/data/models/sharing_relationship_model.dart",
          "lib/features/sharing/domain/entities/sharing_relationship.dart",
          "lib/features/sharing/presentation/bloc/sharing_bloc.dart",
          "lib/features/sharing/presentation/bloc/sharing_state.dart"
        ],
        "filesToCreate": [
          "lib/features/sharing/presentation/widgets/friend_avatar.dart",
          "lib/features/sharing/presentation/widgets/online_status_indicator.dart",
          "lib/features/sharing/presentation/widgets/realtime_step_badge.dart"
        ],
        "filesToRead": [
          "lib/features/sharing/presentation/pages/friends_list_page.dart",
          "lib/features/sharing/presentation/widgets/friend_card.dart",
          "lib/features/sharing/domain/entities/sharing_relationship.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-websocket-realtime",
          "epic-websocket-realtime"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Uses existing widget patterns",
          "Extends BLoC states with real-time data",
          "Follows Material Design 3 guidelines"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-goals-ui-enhancement",
        "title": "Goals UI Enhancement",
        "description": "Enhance existing Goals UI to display real ranking data from API, add edit goal functionality, implement real-time progress updates, and improve group progress visualization with animated charts.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/features/goals/presentation/pages/goal_detail_page.dart",
          "lib/features/goals/presentation/pages/goal_rankings_page.dart",
          "lib/features/goals/presentation/pages/goals_list_page.dart",
          "lib/features/goals/presentation/widgets/goal_card.dart",
          "lib/features/goals/presentation/widgets/goal_progress_indicator.dart",
          "lib/features/goals/presentation/bloc/goal_detail_bloc.dart",
          "lib/features/goals/presentation/bloc/goal_detail_event.dart",
          "lib/features/goals/presentation/bloc/goal_detail_state.dart",
          "lib/features/goals/data/datasources/goals_remote_datasource.dart",
          "lib/features/goals/domain/repositories/goals_repository.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart"
        ],
        "filesToCreate": [
          "lib/features/goals/presentation/pages/edit_goal_page.dart",
          "lib/features/goals/presentation/bloc/edit_goal_bloc.dart",
          "lib/features/goals/presentation/bloc/edit_goal_event.dart",
          "lib/features/goals/presentation/bloc/edit_goal_state.dart",
          "lib/features/goals/domain/usecases/update_goal_usecase.dart",
          "lib/features/goals/presentation/widgets/animated_progress_chart.dart",
          "lib/features/goals/presentation/widgets/realtime_progress_indicator.dart"
        ],
        "filesToRead": [
          "lib/features/goals/presentation/pages/goal_detail_page.dart",
          "lib/features/goals/presentation/pages/goal_rankings_page.dart",
          "lib/features/goals/presentation/pages/create_goal_page.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-websocket-realtime",
          "epic-websocket-realtime",
          "epic-push-notifications"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "Follows existing BLoC pattern with separate event/state files",
          "Uses fl_chart for visualizations",
          "Extends existing goal repository"
        ],
        "repoType": "frontend"
      }
    ]
  }
}