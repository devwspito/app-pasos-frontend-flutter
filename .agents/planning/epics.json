{
  "_metadata": {
    "agentType": "planning",
    "taskId": "39ef8662c0b7227b3413c3a8",
    "timestamp": "2026-01-22T22:51:26.974Z",
    "phase": "planning",
    "savedAt": "2026-01-22T22:51:26.974Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "Flutter Test Final con entorno",
    "taskDescription": "Completar App Pasos Flutter - Merge PRs pendientes y Epics faltantes\n\n## Contexto\nLa task anterior (25044f1f7f2c32e9d29cf33f) fue interrumpida dejando trabajo parcial.\nHay 3 PRs APROBADOS por el Judge pendientes de merge y 2 epics sin empezar.\n\nRepositorio: https://github.com/devwspito/app-pasos-frontend-flutter\n\n## Estado Actual en Main\n- ✅ Flutter Foundation (DI, API client, storage, error handling)\n- ✅ UI Foundation (Material 3 theme, go_router, widgets base)\n- ✅ Authentication UI (login, register, forgot password, providers)\n- ✅ Dashboard parcial (models, entities básicos)\n\n## PRs Pendientes de Merge (YA APROBADOS)\n1. PR #6: Flutter Platform Setup (iOS/Android config, pubspec.yaml)\n2. PR #7: Dashboard & Step Tracking Completion (datasources, repository, widgets, charts)\n3. PR #8: Sharing & Friends UI (friend list, share requests, comparisons)\n\n## Trabajo Pendiente\n\n### 1. Merge PRs Aprobados (Prioridad Máxima)\n- Mergear PR #6, #7, #8 a main en orden\n\n### 2. Goals & Groups UI (Epic en progreso)\nLa rama epic/d29cf33f-epic-goals-groups-ui-1mx8rc tiene trabajo parcial.\nCompletar:\n- Goals domain layer (entities, repositories, use cases)\n- Goals data layer (models, datasources, repository impl)\n- Goals presentation (screens, widgets, Riverpod providers)\n- Groups functionality (crear/unirse grupos, rankings)\n- Crear PR y mergear\n\n### 3. Native Health API Integration (Epic nuevo)\n- Configurar permisos HealthKit (iOS Info.plist)\n- Configurar permisos Health Connect (Android manifest)\n- Crear HealthService con abstracción multiplataforma\n- Implementar sincronización automática de pasos\n- Background fetch para actualizaciones periódicas\n\n### 4. Real-Time WebSocket Client (Epic nuevo)\n- Cliente Socket.io para conexión con backend\n- Handlers para eventos de pasos en tiempo real\n- Sincronización bidireccional de datos\n- Reconexión automática y manejo de offline\n- Notificaciones push de actividad de amigos\n\n## Stack\n- Flutter 3.x con Clean Architecture\n- Riverpod para state management\n- go_router para navegación\n- fl_chart para gráficos\n- health package para HealthKit/Health Connect\n- socket_io_client para WebSockets\n\n## Notas\n- El backend ya tiene Socket.io implementado (repo: project-app-pasos-backend)\n- Coordinar endpoints con backend para health sync",
    "epicsCount": 5,
    "epics": [
      {
        "id": "epic-merge-prs-complete-dashboard",
        "title": "Merge PRs & Complete Dashboard Implementation",
        "description": "Merge approved PRs #6, #7, #8 and implement the actual code for Dashboard & Step Tracking. PRs contain only architecture JSON files, actual Flutter code must be implemented.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/app.dart",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "lib/features/steps/data/datasources/steps_remote_data_source.dart",
          "lib/features/steps/data/datasources/steps_remote_data_source_impl.dart",
          "lib/features/steps/data/repositories/steps_repository_impl.dart",
          "lib/features/steps/presentation/screens/dashboard_screen.dart",
          "lib/features/steps/presentation/widgets/step_counter_widget.dart",
          "lib/features/steps/presentation/widgets/weekly_chart_widget.dart",
          "lib/features/steps/presentation/widgets/hourly_chart_widget.dart",
          "lib/features/steps/presentation/widgets/progress_ring_widget.dart",
          "android/app/build.gradle",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist",
          "ios/Runner.xcodeproj/project.pbxproj"
        ],
        "filesToRead": [
          "lib/features/steps/domain/repositories/steps_repository.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart",
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Clean Architecture data layer pattern from goals",
          "Riverpod StateNotifier pattern from steps_provider",
          "ApiClient HTTP methods for remote data source"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-sharing-friends-ui",
        "title": "Sharing & Friends UI Implementation",
        "description": "Implement the Sharing & Friends feature UI including friend list, share requests, step comparisons, and friend activity feed. Connect to backend /api/sharing endpoints.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/core/constants/api_endpoints.dart",
          "lib/app.dart"
        ],
        "filesToCreate": [
          "lib/features/sharing/domain/entities/friend.dart",
          "lib/features/sharing/domain/entities/sharing_request.dart",
          "lib/features/sharing/domain/repositories/sharing_repository.dart",
          "lib/features/sharing/domain/usecases/get_friends_usecase.dart",
          "lib/features/sharing/domain/usecases/send_friend_request_usecase.dart",
          "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
          "lib/features/sharing/domain/usecases/get_friend_steps_usecase.dart",
          "lib/features/sharing/data/models/friend_model.dart",
          "lib/features/sharing/data/models/sharing_request_model.dart",
          "lib/features/sharing/data/datasources/sharing_remote_data_source.dart",
          "lib/features/sharing/data/datasources/sharing_remote_data_source_impl.dart",
          "lib/features/sharing/data/repositories/sharing_repository_impl.dart",
          "lib/features/sharing/presentation/providers/sharing_provider.dart",
          "lib/features/sharing/presentation/providers/sharing_state.dart",
          "lib/features/sharing/presentation/screens/friends_screen.dart",
          "lib/features/sharing/presentation/screens/friend_requests_screen.dart",
          "lib/features/sharing/presentation/screens/friend_detail_screen.dart",
          "lib/features/sharing/presentation/widgets/friend_card_widget.dart",
          "lib/features/sharing/presentation/widgets/friend_request_card_widget.dart",
          "lib/features/sharing/presentation/widgets/comparison_chart_widget.dart"
        ],
        "filesToRead": [
          "lib/features/steps/presentation/providers/steps_provider.dart",
          "lib/features/steps/domain/entities/step_stats.dart",
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-merge-prs-complete-dashboard",
          "epic-merge-prs-complete-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean Architecture pattern from steps feature",
          "StateNotifier pattern with status/loading/error states",
          "Repository pattern with abstract interface and impl"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-goals-groups-ui-completion",
        "title": "Goals & Groups UI Completion",
        "description": "Complete the Goals & Groups UI epic from branch epic/d29cf33f-epic-goals-groups-ui-1mx8rc. Domain and data layers exist, need presentation screens and widgets for goals management and group functionality.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart",
          "lib/app.dart"
        ],
        "filesToCreate": [
          "lib/features/goals/presentation/screens/goals_list_screen.dart",
          "lib/features/goals/presentation/screens/goal_detail_screen.dart",
          "lib/features/goals/presentation/screens/create_goal_screen.dart",
          "lib/features/goals/presentation/screens/invite_members_screen.dart",
          "lib/features/goals/presentation/widgets/goal_card_widget.dart",
          "lib/features/goals/presentation/widgets/goal_progress_widget.dart",
          "lib/features/goals/presentation/widgets/member_list_widget.dart",
          "lib/features/goals/presentation/widgets/goal_leaderboard_widget.dart",
          "lib/features/groups/domain/entities/group.dart",
          "lib/features/groups/domain/entities/group_member.dart",
          "lib/features/groups/domain/repositories/groups_repository.dart",
          "lib/features/groups/domain/usecases/create_group_usecase.dart",
          "lib/features/groups/domain/usecases/join_group_usecase.dart",
          "lib/features/groups/domain/usecases/get_group_rankings_usecase.dart",
          "lib/features/groups/data/models/group_model.dart",
          "lib/features/groups/data/datasources/groups_remote_data_source.dart",
          "lib/features/groups/data/repositories/groups_repository_impl.dart",
          "lib/features/groups/presentation/providers/groups_provider.dart",
          "lib/features/groups/presentation/screens/groups_list_screen.dart",
          "lib/features/groups/presentation/screens/group_detail_screen.dart",
          "lib/features/groups/presentation/screens/create_group_screen.dart",
          "lib/features/groups/presentation/widgets/group_card_widget.dart",
          "lib/features/groups/presentation/widgets/rankings_widget.dart"
        ],
        "filesToRead": [
          "lib/features/goals/domain/entities/goal.dart",
          "lib/features/goals/domain/repositories/goals_repository.dart",
          "lib/features/goals/presentation/providers/goals_state.dart",
          "lib/features/steps/presentation/widgets/weekly_chart_widget.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-merge-prs-complete-dashboard",
          "epic-merge-prs-complete-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Goals domain layer already implemented",
          "Riverpod GoalsNotifier pattern established",
          "Clean Architecture with use cases"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-native-health-api",
        "title": "Native Health API Integration",
        "description": "Integrate native health APIs (HealthKit on iOS, Health Connect on Android) to read step data from device health systems. Implement background sync and permission handling.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist",
          "lib/core/di/injection_container.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart"
        ],
        "filesToCreate": [
          "lib/core/health/health_service.dart",
          "lib/core/health/health_service_impl.dart",
          "lib/core/health/health_permissions.dart",
          "lib/core/health/models/health_step_data.dart",
          "lib/features/steps/domain/usecases/sync_health_steps_usecase.dart",
          "lib/features/steps/data/datasources/health_local_data_source.dart",
          "lib/features/steps/data/datasources/health_local_data_source_impl.dart",
          "lib/features/steps/presentation/screens/health_permissions_screen.dart",
          "lib/features/steps/presentation/widgets/health_sync_status_widget.dart",
          "lib/core/background/background_service.dart",
          "lib/core/background/background_fetch_handler.dart",
          "android/app/src/main/kotlin/com/apppasos/HealthConnectManager.kt",
          "ios/Runner/HealthKitManager.swift"
        ],
        "filesToRead": [
          "lib/features/steps/domain/repositories/steps_repository.dart",
          "lib/features/steps/data/repositories/steps_repository_impl.dart",
          "lib/core/storage/local_storage.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-merge-prs-complete-dashboard",
          "epic-merge-prs-complete-dashboard"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Service abstraction pattern from api_client",
          "Repository pattern for data sources",
          "GetIt dependency injection"
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-realtime-websocket-client",
        "title": "Real-Time WebSocket Client",
        "description": "Implement Socket.io client to connect with backend WebSocket server for real-time step updates, friend activity notifications, and goal progress synchronization.",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/core/di/injection_container.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart",
          "lib/features/sharing/presentation/providers/sharing_provider.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart"
        ],
        "filesToCreate": [
          "lib/core/realtime/socket_service.dart",
          "lib/core/realtime/socket_service_impl.dart",
          "lib/core/realtime/socket_events.dart",
          "lib/core/realtime/socket_connection_state.dart",
          "lib/core/realtime/handlers/steps_socket_handler.dart",
          "lib/core/realtime/handlers/goals_socket_handler.dart",
          "lib/core/realtime/handlers/sharing_socket_handler.dart",
          "lib/features/notifications/domain/entities/activity_notification.dart",
          "lib/features/notifications/presentation/providers/notifications_provider.dart",
          "lib/features/notifications/presentation/widgets/notification_badge_widget.dart",
          "lib/features/notifications/presentation/screens/notifications_screen.dart"
        ],
        "filesToRead": [
          "lib/core/storage/secure_storage.dart",
          "lib/core/network/api_client.dart",
          "lib/features/auth/data/models/auth_tokens_model.dart"
        ],
        "estimatedComplexity": "high",
        "dependencies": [
          "epic-merge-prs-complete-dashboard",
          "epic-sharing-friends-ui",
          "epic-goals-groups-ui-completion",
          "epic-merge-prs-complete-dashboard",
          "epic-sharing-friends-ui",
          "epic-goals-groups-ui-completion",
          "epic-native-health-api"
        ],
        "executionOrder": 4,
        "followsPatterns": [
          "Backend Socket.io types from src/socket/types.ts",
          "Event-based handlers pattern from backend goals.handler.ts",
          "Service singleton pattern with GetIt"
        ],
        "repoType": "frontend"
      }
    ]
  }
}