{
  "_metadata": {
    "agentType": "planning",
    "taskId": "c411bdaf6f49b40c30423973",
    "timestamp": "2026-01-26T17:01:45.012Z",
    "phase": "planning",
    "savedAt": "2026-01-26T17:01:45.012Z",
    "version": "1.0"
  },
  "data": {
    "taskTitle": "FNN121",
    "taskDescription": "Descripción de tareas para completar el frontend en Flutter\n\nCompletar los 9 epics del frontend de la aplicación \"Pasos\" (contador de pasos social) usando Flutter.\n\n================================================================================\n\nCONTEXTO\n\n================================================================================\n\nEl backend ya está completo en: project-app-pasos-backend\n\nEl frontend debe ir en: project-app-pasos-frontend-flutter (crear nueva estructura)\n\nUsar Flutter para aplicación móvil nativa multiplataforma (iOS/Android)\n\n================================================================================\n\nEPICS A IMPLEMENTAR\n\n================================================================================\n\nFLUTTER FOUNDATION\n\nSetup de Flutter + estructura del proyecto\n\nConfiguración de dependencias base (provider/bloc, dio, etc.)\n\nPLATFORM CONFIG\n\nConfiguración para iOS/Android\n\nPermisos para Health APIs (HealthKit/Google Fit)\n\nConfiguración de AndroidManifest.xml y Info.plist\n\nUI FOUNDATION\n\nSistema de diseño con Material Design 3\n\nRouting y navegación (go_router)\n\nTema oscuro/claro (ThemeData)\n\nWidgets reutilizables\n\nAUTH UI\n\nPantallas de login, registro y recuperación de contraseña\n\nGestión de estado de autenticación\n\nAlmacenamiento seguro de tokens (flutter_secure_storage)\n\nDASHBOARD\n\nVista principal con contador de pasos\n\nHistorial de actividad\n\nGráficos (fl_chart o charts_flutter)\n\nPull-to-refresh\n\nSHARING UI\n\nLista de amigos\n\nGestión de compartir datos con amigos\n\nSolicitudes de amistad\n\nVista de actividad de amigos\n\nGOALS UI\n\nGrupos y metas compartidas\n\nCreación y edición de metas\n\nProgreso de grupos\n\nRankings\n\nNATIVE INTEGRATION\n\nIntegración con podómetro nativo usando health package\n\nLectura de pasos desde HealthKit (iOS)\n\nLectura de pasos desde Google Fit/Health Connect (Android)\n\nBackground sync de datos\n\nREAL-TIME CLIENT\n\nIntegración WebSocket con web_socket_channel\n\nActualizaciones en tiempo real\n\nNotificaciones push (firebase_messaging)\n\nManejo de reconexión",
    "epicsCount": 9,
    "epics": [
      {
        "id": "epic-flutter-foundation",
        "title": "Flutter Foundation - Project Setup and Core Dependencies",
        "description": "Set up Flutter project structure with all required dependencies including state management (Riverpod), HTTP client (Dio), secure storage, and establish clean architecture folder structure",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/main.dart",
          "analysis_options.yaml"
        ],
        "filesToCreate": [
          "lib/core/di/injection_container.dart",
          "lib/core/constants/api_constants.dart",
          "lib/core/constants/app_constants.dart",
          "lib/core/errors/exceptions.dart",
          "lib/core/errors/failures.dart",
          "lib/core/network/api_client.dart",
          "lib/core/network/api_interceptor.dart",
          "lib/core/network/network_info.dart",
          "lib/core/utils/logger.dart",
          "lib/core/utils/validators.dart",
          "lib/core/extensions/context_extensions.dart",
          "lib/core/extensions/string_extensions.dart",
          "lib/env/env.dart",
          "lib/env/env.g.dart"
        ],
        "filesToRead": [
          "pubspec.yaml",
          "lib/main.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "executionOrder": 1,
        "followsPatterns": [
          "Clean architecture folder structure",
          "Dependency injection with get_it",
          "Environment configuration with envied"
        ],
        "stories": [
          {
            "id": "story-flutter-foundation-1",
            "title": "Configure pubspec.yaml with all required dependencies",
            "description": "Add flutter_riverpod, dio, flutter_secure_storage, get_it, injectable, envied, freezed, json_annotation, go_router, and dev dependencies",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-flutter-foundation-2",
            "title": "Create core folder structure and DI container",
            "description": "Set up lib/core/, lib/features/, lib/shared/ folders and configure get_it dependency injection",
            "filesToCreate": [
              "lib/core/di/injection_container.dart"
            ],
            "priority": 2,
            "complexity": "simple"
          },
          {
            "id": "story-flutter-foundation-3",
            "title": "Implement API client with Dio",
            "description": "Create Dio-based API client with interceptors for auth tokens, error handling, and logging",
            "filesToCreate": [
              "lib/core/network/api_client.dart",
              "lib/core/network/api_interceptor.dart",
              "lib/core/network/network_info.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-flutter-foundation-4",
            "title": "Create error handling infrastructure",
            "description": "Implement custom exceptions, failures, and Result pattern for consistent error handling",
            "filesToCreate": [
              "lib/core/errors/exceptions.dart",
              "lib/core/errors/failures.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-flutter-foundation-5",
            "title": "Set up environment configuration",
            "description": "Configure envied for environment variables (API URL, etc) with dev/prod environments",
            "filesToCreate": [
              "lib/env/env.dart",
              "lib/env/env.g.dart",
              ".env",
              ".env.example"
            ],
            "priority": 5,
            "complexity": "simple"
          },
          {
            "id": "story-flutter-foundation-6",
            "title": "Create utility classes and extensions",
            "description": "Implement logger, validators, and common extensions for BuildContext and String",
            "filesToCreate": [
              "lib/core/utils/logger.dart",
              "lib/core/utils/validators.dart",
              "lib/core/extensions/context_extensions.dart",
              "lib/core/extensions/string_extensions.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-platform-config",
        "title": "Platform Configuration - iOS and Android Health API Permissions",
        "description": "Configure platform-specific settings for iOS HealthKit and Android Health Connect/Google Fit permissions, including AndroidManifest.xml and Info.plist modifications",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist",
          "android/app/build.gradle",
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "android/app/src/main/res/values/health_permissions.xml",
          "ios/Runner/Runner.entitlements"
        ],
        "filesToRead": [
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist",
          "android/app/build.gradle"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-flutter-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Platform-specific configuration",
          "Permission declarations",
          "Health API integration requirements"
        ],
        "stories": [
          {
            "id": "story-platform-config-1",
            "title": "Configure Android permissions for Health Connect",
            "description": "Add activity recognition, body sensors, and Health Connect permissions to AndroidManifest.xml. Update minSdkVersion to 26 for Health Connect support",
            "filesToModify": [
              "android/app/src/main/AndroidManifest.xml",
              "android/app/build.gradle"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-platform-config-2",
            "title": "Configure iOS HealthKit permissions",
            "description": "Add NSHealthShareUsageDescription, NSHealthUpdateUsageDescription to Info.plist and configure HealthKit entitlements",
            "filesToModify": [
              "ios/Runner/Info.plist"
            ],
            "filesToCreate": [
              "ios/Runner/Runner.entitlements"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-platform-config-3",
            "title": "Add health package dependency",
            "description": "Add health package to pubspec.yaml with proper version for HealthKit and Health Connect support",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-platform-config-4",
            "title": "Configure Android ProGuard rules",
            "description": "Add ProGuard rules to prevent health-related classes from being stripped in release builds",
            "filesToCreate": [
              "android/app/proguard-rules.pro"
            ],
            "filesToModify": [
              "android/app/build.gradle"
            ],
            "priority": 4,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-ui-foundation",
        "title": "UI Foundation - Design System, Routing, and Theming",
        "description": "Implement Material Design 3 design system with light/dark theme support, go_router navigation setup, and reusable widget library",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart"
        ],
        "filesToCreate": [
          "lib/core/theme/app_theme.dart",
          "lib/core/theme/app_colors.dart",
          "lib/core/theme/app_text_styles.dart",
          "lib/core/theme/app_spacing.dart",
          "lib/core/router/app_router.dart",
          "lib/core/router/route_names.dart",
          "lib/core/router/route_guards.dart",
          "lib/shared/widgets/app_button.dart",
          "lib/shared/widgets/app_text_field.dart",
          "lib/shared/widgets/app_card.dart",
          "lib/shared/widgets/app_loading.dart",
          "lib/shared/widgets/app_error.dart",
          "lib/shared/widgets/app_empty_state.dart",
          "lib/shared/widgets/step_counter_display.dart",
          "lib/shared/widgets/progress_ring.dart",
          "lib/shared/widgets/user_avatar.dart",
          "lib/features/app/app.dart",
          "lib/features/app/app_providers.dart"
        ],
        "filesToRead": [
          "lib/main.dart"
        ],
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-flutter-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Material Design 3 theming",
          "go_router navigation",
          "Reusable widget components"
        ],
        "stories": [
          {
            "id": "story-ui-foundation-1",
            "title": "Implement Material Design 3 theme system",
            "description": "Create AppTheme with light and dark ColorScheme, typography, and component themes following MD3 guidelines",
            "filesToCreate": [
              "lib/core/theme/app_theme.dart",
              "lib/core/theme/app_colors.dart",
              "lib/core/theme/app_text_styles.dart",
              "lib/core/theme/app_spacing.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-ui-foundation-2",
            "title": "Set up go_router navigation",
            "description": "Configure GoRouter with all app routes, nested navigation for bottom tabs, and route guards for authentication",
            "filesToCreate": [
              "lib/core/router/app_router.dart",
              "lib/core/router/route_names.dart",
              "lib/core/router/route_guards.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-ui-foundation-3",
            "title": "Create reusable form widgets",
            "description": "Implement AppButton, AppTextField with validation support, consistent styling",
            "filesToCreate": [
              "lib/shared/widgets/app_button.dart",
              "lib/shared/widgets/app_text_field.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-ui-foundation-4",
            "title": "Create reusable display widgets",
            "description": "Implement AppCard, AppLoading, AppError, AppEmptyState for consistent UI patterns",
            "filesToCreate": [
              "lib/shared/widgets/app_card.dart",
              "lib/shared/widgets/app_loading.dart",
              "lib/shared/widgets/app_error.dart",
              "lib/shared/widgets/app_empty_state.dart"
            ],
            "priority": 4,
            "complexity": "simple"
          },
          {
            "id": "story-ui-foundation-5",
            "title": "Create step-specific widgets",
            "description": "Implement StepCounterDisplay with animated counter, ProgressRing for goals, UserAvatar for profiles",
            "filesToCreate": [
              "lib/shared/widgets/step_counter_display.dart",
              "lib/shared/widgets/progress_ring.dart",
              "lib/shared/widgets/user_avatar.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-ui-foundation-6",
            "title": "Update main.dart with app shell",
            "description": "Refactor main.dart to use new theme system, router, and Riverpod providers",
            "filesToModify": [
              "lib/main.dart"
            ],
            "filesToCreate": [
              "lib/features/app/app.dart",
              "lib/features/app/app_providers.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-auth-ui",
        "title": "Auth UI - Login, Register, and Password Recovery",
        "description": "Implement complete authentication flow with login, registration, password recovery screens, JWT token management, and secure storage",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/auth/data/datasources/auth_remote_datasource.dart",
          "lib/features/auth/data/datasources/auth_local_datasource.dart",
          "lib/features/auth/data/models/user_model.dart",
          "lib/features/auth/data/models/auth_response_model.dart",
          "lib/features/auth/data/repositories/auth_repository_impl.dart",
          "lib/features/auth/domain/entities/user.dart",
          "lib/features/auth/domain/repositories/auth_repository.dart",
          "lib/features/auth/domain/usecases/login_usecase.dart",
          "lib/features/auth/domain/usecases/register_usecase.dart",
          "lib/features/auth/domain/usecases/logout_usecase.dart",
          "lib/features/auth/domain/usecases/get_current_user_usecase.dart",
          "lib/features/auth/presentation/providers/auth_provider.dart",
          "lib/features/auth/presentation/providers/auth_state.dart",
          "lib/features/auth/presentation/screens/login_screen.dart",
          "lib/features/auth/presentation/screens/register_screen.dart",
          "lib/features/auth/presentation/screens/forgot_password_screen.dart",
          "lib/features/auth/presentation/screens/splash_screen.dart",
          "lib/features/auth/presentation/widgets/auth_form.dart",
          "lib/features/auth/presentation/widgets/social_login_buttons.dart"
        ],
        "filesToRead": [
          "lib/core/router/app_router.dart",
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-ui-foundation",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean architecture layers",
          "Riverpod state management",
          "JWT token storage in flutter_secure_storage"
        ],
        "stories": [
          {
            "id": "story-auth-ui-1",
            "title": "Create auth domain layer",
            "description": "Implement User entity, AuthRepository interface, and use cases for login, register, logout, getCurrentUser",
            "filesToCreate": [
              "lib/features/auth/domain/entities/user.dart",
              "lib/features/auth/domain/repositories/auth_repository.dart",
              "lib/features/auth/domain/usecases/login_usecase.dart",
              "lib/features/auth/domain/usecases/register_usecase.dart",
              "lib/features/auth/domain/usecases/logout_usecase.dart",
              "lib/features/auth/domain/usecases/get_current_user_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-ui-2",
            "title": "Create auth data layer",
            "description": "Implement UserModel, AuthResponseModel with JSON serialization, remote and local datasources, repository implementation",
            "filesToCreate": [
              "lib/features/auth/data/models/user_model.dart",
              "lib/features/auth/data/models/auth_response_model.dart",
              "lib/features/auth/data/datasources/auth_remote_datasource.dart",
              "lib/features/auth/data/datasources/auth_local_datasource.dart",
              "lib/features/auth/data/repositories/auth_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-ui-3",
            "title": "Implement auth state management",
            "description": "Create Riverpod providers for authentication state, including login/logout actions and current user state",
            "filesToCreate": [
              "lib/features/auth/presentation/providers/auth_provider.dart",
              "lib/features/auth/presentation/providers/auth_state.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-ui-4",
            "title": "Create login screen",
            "description": "Implement login screen with email/password form, validation, error handling, and navigation to register/forgot password",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/login_screen.dart",
              "lib/features/auth/presentation/widgets/auth_form.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-ui-5",
            "title": "Create registration screen",
            "description": "Implement registration screen with username, email, password fields, validation rules matching backend requirements",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/register_screen.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-auth-ui-6",
            "title": "Create forgot password and splash screens",
            "description": "Implement forgot password flow and splash screen for app initialization with auth state check",
            "filesToCreate": [
              "lib/features/auth/presentation/screens/forgot_password_screen.dart",
              "lib/features/auth/presentation/screens/splash_screen.dart"
            ],
            "priority": 6,
            "complexity": "simple"
          },
          {
            "id": "story-auth-ui-7",
            "title": "Integrate auth routes",
            "description": "Add auth routes to go_router, implement route guards for protected screens, handle token refresh flow",
            "filesToModify": [
              "lib/core/router/app_router.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-dashboard",
        "title": "Dashboard - Step Counter, History, and Charts",
        "description": "Implement main dashboard with live step counter display, activity history, weekly trends chart, and hourly peaks visualization using fl_chart",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/steps/data/datasources/steps_remote_datasource.dart",
          "lib/features/steps/data/datasources/steps_local_datasource.dart",
          "lib/features/steps/data/models/step_model.dart",
          "lib/features/steps/data/models/step_stats_model.dart",
          "lib/features/steps/data/models/weekly_trend_model.dart",
          "lib/features/steps/data/repositories/steps_repository_impl.dart",
          "lib/features/steps/domain/entities/step_record.dart",
          "lib/features/steps/domain/entities/step_stats.dart",
          "lib/features/steps/domain/entities/weekly_trend.dart",
          "lib/features/steps/domain/repositories/steps_repository.dart",
          "lib/features/steps/domain/usecases/get_today_steps_usecase.dart",
          "lib/features/steps/domain/usecases/get_weekly_trend_usecase.dart",
          "lib/features/steps/domain/usecases/get_hourly_peaks_usecase.dart",
          "lib/features/steps/domain/usecases/record_steps_usecase.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart",
          "lib/features/steps/presentation/providers/steps_state.dart",
          "lib/features/steps/presentation/screens/dashboard_screen.dart",
          "lib/features/steps/presentation/screens/history_screen.dart",
          "lib/features/steps/presentation/screens/stats_screen.dart",
          "lib/features/steps/presentation/widgets/today_steps_card.dart",
          "lib/features/steps/presentation/widgets/weekly_chart.dart",
          "lib/features/steps/presentation/widgets/hourly_chart.dart",
          "lib/features/steps/presentation/widgets/stats_summary_card.dart",
          "lib/features/steps/presentation/widgets/activity_timeline.dart",
          "lib/features/home/presentation/screens/home_screen.dart",
          "lib/features/home/presentation/widgets/bottom_navigation.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-ui-foundation",
          "epic-auth-ui",
          "epic-flutter-foundation",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "fl_chart for data visualization",
          "Pull-to-refresh pattern",
          "Clean architecture layers"
        ],
        "stories": [
          {
            "id": "story-dashboard-1",
            "title": "Create steps domain layer",
            "description": "Implement StepRecord, StepStats, WeeklyTrend entities, repository interface, and use cases",
            "filesToCreate": [
              "lib/features/steps/domain/entities/step_record.dart",
              "lib/features/steps/domain/entities/step_stats.dart",
              "lib/features/steps/domain/entities/weekly_trend.dart",
              "lib/features/steps/domain/repositories/steps_repository.dart",
              "lib/features/steps/domain/usecases/get_today_steps_usecase.dart",
              "lib/features/steps/domain/usecases/get_weekly_trend_usecase.dart",
              "lib/features/steps/domain/usecases/get_hourly_peaks_usecase.dart",
              "lib/features/steps/domain/usecases/record_steps_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-2",
            "title": "Create steps data layer",
            "description": "Implement models with JSON serialization, remote/local datasources, repository implementation with caching",
            "filesToCreate": [
              "lib/features/steps/data/models/step_model.dart",
              "lib/features/steps/data/models/step_stats_model.dart",
              "lib/features/steps/data/models/weekly_trend_model.dart",
              "lib/features/steps/data/datasources/steps_remote_datasource.dart",
              "lib/features/steps/data/datasources/steps_local_datasource.dart",
              "lib/features/steps/data/repositories/steps_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-3",
            "title": "Implement steps state management",
            "description": "Create Riverpod providers for today steps, weekly trend, hourly peaks with loading/error states",
            "filesToCreate": [
              "lib/features/steps/presentation/providers/steps_provider.dart",
              "lib/features/steps/presentation/providers/steps_state.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-4",
            "title": "Create dashboard main screen",
            "description": "Implement dashboard screen with today's steps card, quick stats, and navigation to detailed views",
            "filesToCreate": [
              "lib/features/steps/presentation/screens/dashboard_screen.dart",
              "lib/features/steps/presentation/widgets/today_steps_card.dart",
              "lib/features/steps/presentation/widgets/stats_summary_card.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-5",
            "title": "Implement charts with fl_chart",
            "description": "Create weekly bar chart and hourly line chart using fl_chart package for trend visualization",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "filesToCreate": [
              "lib/features/steps/presentation/widgets/weekly_chart.dart",
              "lib/features/steps/presentation/widgets/hourly_chart.dart"
            ],
            "priority": 5,
            "complexity": "complex"
          },
          {
            "id": "story-dashboard-6",
            "title": "Create history and stats screens",
            "description": "Implement history screen with activity timeline and detailed stats screen",
            "filesToCreate": [
              "lib/features/steps/presentation/screens/history_screen.dart",
              "lib/features/steps/presentation/screens/stats_screen.dart",
              "lib/features/steps/presentation/widgets/activity_timeline.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          },
          {
            "id": "story-dashboard-7",
            "title": "Create home shell with bottom navigation",
            "description": "Implement home screen shell with bottom navigation bar for Dashboard, Friends, Goals, Profile tabs",
            "filesToCreate": [
              "lib/features/home/presentation/screens/home_screen.dart",
              "lib/features/home/presentation/widgets/bottom_navigation.dart"
            ],
            "filesToModify": [
              "lib/core/router/app_router.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-sharing-ui",
        "title": "Sharing UI - Friends List and Step Sharing",
        "description": "Implement social features including friends list, sharing requests management, friend activity view, and shared step statistics",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
          "lib/features/sharing/data/models/sharing_relationship_model.dart",
          "lib/features/sharing/data/models/friend_stats_model.dart",
          "lib/features/sharing/data/repositories/sharing_repository_impl.dart",
          "lib/features/sharing/domain/entities/sharing_relationship.dart",
          "lib/features/sharing/domain/entities/friend_stats.dart",
          "lib/features/sharing/domain/repositories/sharing_repository.dart",
          "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
          "lib/features/sharing/domain/usecases/send_request_usecase.dart",
          "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
          "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
          "lib/features/sharing/domain/usecases/get_friend_stats_usecase.dart",
          "lib/features/sharing/presentation/providers/sharing_provider.dart",
          "lib/features/sharing/presentation/providers/sharing_state.dart",
          "lib/features/sharing/presentation/screens/friends_screen.dart",
          "lib/features/sharing/presentation/screens/friend_requests_screen.dart",
          "lib/features/sharing/presentation/screens/friend_detail_screen.dart",
          "lib/features/sharing/presentation/screens/add_friend_screen.dart",
          "lib/features/sharing/presentation/widgets/friend_card.dart",
          "lib/features/sharing/presentation/widgets/friend_request_card.dart",
          "lib/features/sharing/presentation/widgets/friend_activity_card.dart",
          "lib/features/sharing/presentation/widgets/user_search_delegate.dart",
          "lib/features/users/data/datasources/users_remote_datasource.dart",
          "lib/features/users/data/models/user_search_model.dart",
          "lib/features/users/domain/usecases/search_users_usecase.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-ui-foundation",
          "epic-auth-ui",
          "epic-dashboard",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean architecture layers",
          "Search delegate pattern",
          "Pull-to-refresh for lists"
        ],
        "stories": [
          {
            "id": "story-sharing-1",
            "title": "Create sharing domain layer",
            "description": "Implement SharingRelationship, FriendStats entities, repository interface, and all use cases",
            "filesToCreate": [
              "lib/features/sharing/domain/entities/sharing_relationship.dart",
              "lib/features/sharing/domain/entities/friend_stats.dart",
              "lib/features/sharing/domain/repositories/sharing_repository.dart",
              "lib/features/sharing/domain/usecases/get_relationships_usecase.dart",
              "lib/features/sharing/domain/usecases/send_request_usecase.dart",
              "lib/features/sharing/domain/usecases/accept_request_usecase.dart",
              "lib/features/sharing/domain/usecases/reject_request_usecase.dart",
              "lib/features/sharing/domain/usecases/get_friend_stats_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-2",
            "title": "Create sharing data layer",
            "description": "Implement models, remote datasource with API calls, repository implementation",
            "filesToCreate": [
              "lib/features/sharing/data/models/sharing_relationship_model.dart",
              "lib/features/sharing/data/models/friend_stats_model.dart",
              "lib/features/sharing/data/datasources/sharing_remote_datasource.dart",
              "lib/features/sharing/data/repositories/sharing_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-3",
            "title": "Implement user search feature",
            "description": "Create user search datasource, model, and use case for finding friends by username",
            "filesToCreate": [
              "lib/features/users/data/datasources/users_remote_datasource.dart",
              "lib/features/users/data/models/user_search_model.dart",
              "lib/features/users/domain/usecases/search_users_usecase.dart"
            ],
            "priority": 3,
            "complexity": "simple"
          },
          {
            "id": "story-sharing-4",
            "title": "Implement sharing state management",
            "description": "Create Riverpod providers for relationships, pending requests, and friend stats",
            "filesToCreate": [
              "lib/features/sharing/presentation/providers/sharing_provider.dart",
              "lib/features/sharing/presentation/providers/sharing_state.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-5",
            "title": "Create friends list screen",
            "description": "Implement main friends screen showing accepted relationships with their step activity",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/friends_screen.dart",
              "lib/features/sharing/presentation/widgets/friend_card.dart",
              "lib/features/sharing/presentation/widgets/friend_activity_card.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-6",
            "title": "Create friend requests screen",
            "description": "Implement screen for managing incoming/outgoing friend requests with accept/reject actions",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/friend_requests_screen.dart",
              "lib/features/sharing/presentation/widgets/friend_request_card.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          },
          {
            "id": "story-sharing-7",
            "title": "Create add friend and detail screens",
            "description": "Implement user search screen for adding friends and friend detail screen with full stats",
            "filesToCreate": [
              "lib/features/sharing/presentation/screens/add_friend_screen.dart",
              "lib/features/sharing/presentation/screens/friend_detail_screen.dart",
              "lib/features/sharing/presentation/widgets/user_search_delegate.dart"
            ],
            "filesToModify": [
              "lib/core/router/app_router.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-goals-ui",
        "title": "Goals UI - Groups, Shared Goals, and Progress Tracking",
        "description": "Implement group goals feature with goal creation, member management, progress tracking, rankings, and invitation system",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/goals/data/datasources/goals_remote_datasource.dart",
          "lib/features/goals/data/models/goal_model.dart",
          "lib/features/goals/data/models/goal_member_model.dart",
          "lib/features/goals/data/models/goal_progress_model.dart",
          "lib/features/goals/data/repositories/goals_repository_impl.dart",
          "lib/features/goals/domain/entities/goal.dart",
          "lib/features/goals/domain/entities/goal_member.dart",
          "lib/features/goals/domain/entities/goal_progress.dart",
          "lib/features/goals/domain/repositories/goals_repository.dart",
          "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
          "lib/features/goals/domain/usecases/create_goal_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
          "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart",
          "lib/features/goals/domain/usecases/invite_to_goal_usecase.dart",
          "lib/features/goals/domain/usecases/join_goal_usecase.dart",
          "lib/features/goals/domain/usecases/leave_goal_usecase.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart",
          "lib/features/goals/presentation/providers/goals_state.dart",
          "lib/features/goals/presentation/screens/goals_screen.dart",
          "lib/features/goals/presentation/screens/goal_detail_screen.dart",
          "lib/features/goals/presentation/screens/create_goal_screen.dart",
          "lib/features/goals/presentation/screens/goal_invitations_screen.dart",
          "lib/features/goals/presentation/widgets/goal_card.dart",
          "lib/features/goals/presentation/widgets/goal_progress_card.dart",
          "lib/features/goals/presentation/widgets/member_ranking_list.dart",
          "lib/features/goals/presentation/widgets/invite_member_sheet.dart",
          "lib/features/goals/presentation/widgets/goal_form.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-ui-foundation",
          "epic-auth-ui",
          "epic-sharing-ui",
          "epic-ui-foundation"
        ],
        "executionOrder": 2,
        "followsPatterns": [
          "Clean architecture layers",
          "Bottom sheet for actions",
          "Form validation pattern"
        ],
        "stories": [
          {
            "id": "story-goals-1",
            "title": "Create goals domain layer",
            "description": "Implement Goal, GoalMember, GoalProgress entities, repository interface, and all use cases",
            "filesToCreate": [
              "lib/features/goals/domain/entities/goal.dart",
              "lib/features/goals/domain/entities/goal_member.dart",
              "lib/features/goals/domain/entities/goal_progress.dart",
              "lib/features/goals/domain/repositories/goals_repository.dart",
              "lib/features/goals/domain/usecases/get_user_goals_usecase.dart",
              "lib/features/goals/domain/usecases/create_goal_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_details_usecase.dart",
              "lib/features/goals/domain/usecases/get_goal_progress_usecase.dart",
              "lib/features/goals/domain/usecases/invite_to_goal_usecase.dart",
              "lib/features/goals/domain/usecases/join_goal_usecase.dart",
              "lib/features/goals/domain/usecases/leave_goal_usecase.dart"
            ],
            "priority": 1,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-2",
            "title": "Create goals data layer",
            "description": "Implement models with JSON serialization, remote datasource, repository implementation",
            "filesToCreate": [
              "lib/features/goals/data/models/goal_model.dart",
              "lib/features/goals/data/models/goal_member_model.dart",
              "lib/features/goals/data/models/goal_progress_model.dart",
              "lib/features/goals/data/datasources/goals_remote_datasource.dart",
              "lib/features/goals/data/repositories/goals_repository_impl.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-3",
            "title": "Implement goals state management",
            "description": "Create Riverpod providers for user goals, goal details, progress, and invitations",
            "filesToCreate": [
              "lib/features/goals/presentation/providers/goals_provider.dart",
              "lib/features/goals/presentation/providers/goals_state.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-4",
            "title": "Create goals list screen",
            "description": "Implement main goals screen showing active and completed goals with filters",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/goals_screen.dart",
              "lib/features/goals/presentation/widgets/goal_card.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-5",
            "title": "Create goal detail screen",
            "description": "Implement goal detail screen with progress visualization, member list, and rankings",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/goal_detail_screen.dart",
              "lib/features/goals/presentation/widgets/goal_progress_card.dart",
              "lib/features/goals/presentation/widgets/member_ranking_list.dart"
            ],
            "priority": 5,
            "complexity": "complex"
          },
          {
            "id": "story-goals-6",
            "title": "Create goal creation screen",
            "description": "Implement goal creation form with title, description, target steps, date range validation",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/create_goal_screen.dart",
              "lib/features/goals/presentation/widgets/goal_form.dart"
            ],
            "priority": 6,
            "complexity": "moderate"
          },
          {
            "id": "story-goals-7",
            "title": "Create invitations and member management",
            "description": "Implement goal invitations screen and invite member bottom sheet with friend selection",
            "filesToCreate": [
              "lib/features/goals/presentation/screens/goal_invitations_screen.dart",
              "lib/features/goals/presentation/widgets/invite_member_sheet.dart"
            ],
            "filesToModify": [
              "lib/core/router/app_router.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-native-integration",
        "title": "Native Integration - Health API and Background Step Sync",
        "description": "Integrate with native health APIs (HealthKit for iOS, Health Connect for Android) using health package for automatic step data synchronization with background sync capability",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "lib/main.dart",
          "lib/features/steps/data/repositories/steps_repository_impl.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart"
        ],
        "filesToCreate": [
          "lib/core/services/health_service.dart",
          "lib/core/services/background_sync_service.dart",
          "lib/core/services/permission_service.dart",
          "lib/features/health/data/datasources/health_datasource.dart",
          "lib/features/health/data/models/health_step_model.dart",
          "lib/features/health/domain/entities/health_step.dart",
          "lib/features/health/domain/repositories/health_repository.dart",
          "lib/features/health/domain/usecases/get_health_steps_usecase.dart",
          "lib/features/health/domain/usecases/request_health_permissions_usecase.dart",
          "lib/features/health/presentation/providers/health_provider.dart",
          "lib/features/health/presentation/screens/health_permissions_screen.dart",
          "lib/features/health/presentation/widgets/permission_request_card.dart",
          "lib/features/health/presentation/widgets/sync_status_indicator.dart",
          "lib/features/settings/presentation/screens/settings_screen.dart",
          "lib/features/settings/presentation/widgets/health_sync_settings.dart"
        ],
        "filesToRead": [
          "lib/features/steps/data/repositories/steps_repository_impl.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-platform-config",
          "epic-dashboard",
          "epic-flutter-foundation",
          "epic-dashboard"
        ],
        "executionOrder": 3,
        "followsPatterns": [
          "Platform-specific service implementation",
          "Background task handling",
          "Permission request flow"
        ],
        "stories": [
          {
            "id": "story-native-1",
            "title": "Implement health service wrapper",
            "description": "Create HealthService that wraps health package with platform-specific initialization and permission handling",
            "filesToCreate": [
              "lib/core/services/health_service.dart",
              "lib/core/services/permission_service.dart"
            ],
            "priority": 1,
            "complexity": "complex"
          },
          {
            "id": "story-native-2",
            "title": "Create health domain layer",
            "description": "Implement HealthStep entity, repository interface, and use cases for reading health data and permissions",
            "filesToCreate": [
              "lib/features/health/domain/entities/health_step.dart",
              "lib/features/health/domain/repositories/health_repository.dart",
              "lib/features/health/domain/usecases/get_health_steps_usecase.dart",
              "lib/features/health/domain/usecases/request_health_permissions_usecase.dart"
            ],
            "priority": 2,
            "complexity": "moderate"
          },
          {
            "id": "story-native-3",
            "title": "Create health data layer",
            "description": "Implement HealthStepModel, datasource that reads from health package, repository implementation",
            "filesToCreate": [
              "lib/features/health/data/models/health_step_model.dart",
              "lib/features/health/data/datasources/health_datasource.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-native-4",
            "title": "Implement health state management",
            "description": "Create Riverpod providers for health permissions status, sync state, and step data",
            "filesToCreate": [
              "lib/features/health/presentation/providers/health_provider.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-native-5",
            "title": "Create health permissions screen",
            "description": "Implement onboarding screen for requesting health permissions with explanation",
            "filesToCreate": [
              "lib/features/health/presentation/screens/health_permissions_screen.dart",
              "lib/features/health/presentation/widgets/permission_request_card.dart"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-native-6",
            "title": "Implement background sync service",
            "description": "Create BackgroundSyncService for periodic step data synchronization with battery optimization",
            "filesToCreate": [
              "lib/core/services/background_sync_service.dart"
            ],
            "filesToModify": [
              "lib/main.dart"
            ],
            "priority": 6,
            "complexity": "complex"
          },
          {
            "id": "story-native-7",
            "title": "Create settings screen with sync options",
            "description": "Implement settings screen with health sync toggle, manual sync button, and sync status indicator",
            "filesToCreate": [
              "lib/features/settings/presentation/screens/settings_screen.dart",
              "lib/features/settings/presentation/widgets/health_sync_settings.dart",
              "lib/features/health/presentation/widgets/sync_status_indicator.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          },
          {
            "id": "story-native-8",
            "title": "Integrate health data with steps repository",
            "description": "Update steps repository to merge health API data with backend data, handle conflicts",
            "filesToModify": [
              "lib/features/steps/data/repositories/steps_repository_impl.dart",
              "lib/features/steps/presentation/providers/steps_provider.dart"
            ],
            "priority": 8,
            "complexity": "complex"
          }
        ],
        "repoType": "frontend"
      },
      {
        "id": "epic-realtime-client",
        "title": "Real-Time Client - WebSocket and Push Notifications",
        "description": "Implement WebSocket client for real-time step updates and goal progress, plus Firebase Cloud Messaging for push notifications",
        "targetRepository": "app-pasos-frontend-flutter",
        "affectedRepositories": [
          "app-pasos-frontend-flutter"
        ],
        "filesToModify": [
          "pubspec.yaml",
          "lib/main.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart",
          "lib/features/goals/presentation/providers/goals_provider.dart",
          "android/app/build.gradle",
          "android/app/src/main/AndroidManifest.xml",
          "ios/Runner/Info.plist"
        ],
        "filesToCreate": [
          "lib/core/services/socket_service.dart",
          "lib/core/services/notification_service.dart",
          "lib/core/services/push_notification_service.dart",
          "lib/features/realtime/data/models/socket_event_model.dart",
          "lib/features/realtime/domain/entities/socket_event.dart",
          "lib/features/realtime/presentation/providers/socket_provider.dart",
          "lib/features/notifications/data/datasources/notification_local_datasource.dart",
          "lib/features/notifications/data/models/notification_model.dart",
          "lib/features/notifications/domain/entities/app_notification.dart",
          "lib/features/notifications/presentation/providers/notification_provider.dart",
          "lib/features/notifications/presentation/screens/notifications_screen.dart",
          "lib/features/notifications/presentation/widgets/notification_card.dart",
          "lib/features/notifications/presentation/widgets/notification_badge.dart",
          "android/app/google-services.json",
          "ios/Runner/GoogleService-Info.plist",
          "firebase_options.dart"
        ],
        "filesToRead": [
          "lib/core/network/api_client.dart",
          "lib/features/steps/presentation/providers/steps_provider.dart"
        ],
        "estimatedComplexity": "complex",
        "dependencies": [
          "epic-flutter-foundation",
          "epic-auth-ui",
          "epic-dashboard",
          "epic-sharing-ui",
          "epic-goals-ui",
          "epic-flutter-foundation",
          "epic-platform-config",
          "epic-dashboard",
          "epic-goals-ui"
        ],
        "executionOrder": 4,
        "followsPatterns": [
          "WebSocket with automatic reconnection",
          "Firebase Cloud Messaging setup",
          "Local notification handling"
        ],
        "stories": [
          {
            "id": "story-realtime-1",
            "title": "Add WebSocket and Firebase dependencies",
            "description": "Add web_socket_channel, firebase_core, firebase_messaging, flutter_local_notifications to pubspec.yaml",
            "filesToModify": [
              "pubspec.yaml"
            ],
            "priority": 1,
            "complexity": "simple"
          },
          {
            "id": "story-realtime-2",
            "title": "Implement WebSocket service",
            "description": "Create SocketService with connection management, authentication, automatic reconnection, and event handling",
            "filesToCreate": [
              "lib/core/services/socket_service.dart",
              "lib/features/realtime/data/models/socket_event_model.dart",
              "lib/features/realtime/domain/entities/socket_event.dart"
            ],
            "priority": 2,
            "complexity": "complex"
          },
          {
            "id": "story-realtime-3",
            "title": "Implement WebSocket state management",
            "description": "Create Riverpod provider for socket connection state and event streaming",
            "filesToCreate": [
              "lib/features/realtime/presentation/providers/socket_provider.dart"
            ],
            "priority": 3,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-4",
            "title": "Integrate real-time updates with providers",
            "description": "Update steps and goals providers to listen for real-time WebSocket events and update state",
            "filesToModify": [
              "lib/features/steps/presentation/providers/steps_provider.dart",
              "lib/features/goals/presentation/providers/goals_provider.dart"
            ],
            "priority": 4,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-5",
            "title": "Configure Firebase for push notifications",
            "description": "Set up Firebase project, add google-services.json and GoogleService-Info.plist, configure Android/iOS",
            "filesToCreate": [
              "android/app/google-services.json",
              "ios/Runner/GoogleService-Info.plist",
              "firebase_options.dart"
            ],
            "filesToModify": [
              "android/app/build.gradle",
              "android/app/src/main/AndroidManifest.xml",
              "ios/Runner/Info.plist"
            ],
            "priority": 5,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-6",
            "title": "Implement push notification service",
            "description": "Create PushNotificationService for FCM token management, message handling, and local notifications",
            "filesToCreate": [
              "lib/core/services/push_notification_service.dart",
              "lib/core/services/notification_service.dart"
            ],
            "filesToModify": [
              "lib/main.dart"
            ],
            "priority": 6,
            "complexity": "complex"
          },
          {
            "id": "story-realtime-7",
            "title": "Create notifications feature",
            "description": "Implement notification entity, model, local storage, and state management for in-app notifications",
            "filesToCreate": [
              "lib/features/notifications/domain/entities/app_notification.dart",
              "lib/features/notifications/data/models/notification_model.dart",
              "lib/features/notifications/data/datasources/notification_local_datasource.dart",
              "lib/features/notifications/presentation/providers/notification_provider.dart"
            ],
            "priority": 7,
            "complexity": "moderate"
          },
          {
            "id": "story-realtime-8",
            "title": "Create notifications UI",
            "description": "Implement notifications screen, notification cards, and badge indicator for unread count",
            "filesToCreate": [
              "lib/features/notifications/presentation/screens/notifications_screen.dart",
              "lib/features/notifications/presentation/widgets/notification_card.dart",
              "lib/features/notifications/presentation/widgets/notification_badge.dart"
            ],
            "priority": 8,
            "complexity": "moderate"
          }
        ],
        "repoType": "frontend"
      }
    ]
  }
}