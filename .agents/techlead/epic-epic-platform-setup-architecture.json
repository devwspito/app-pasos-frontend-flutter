{
  "_metadata": {
    "agentType": "techlead",
    "taskId": "19767cb565ca6124e8ef47b9",
    "timestamp": "2026-01-22T23:36:28.370Z",
    "phase": "techlead",
    "epicId": "epic-platform-setup",
    "savedAt": "2026-01-22T23:36:28.371Z",
    "version": "1.0"
  },
  "data": {
    "epicId": "epic-platform-setup",
    "storiesCount": 4,
    "architecture": "## Flutter Platform Setup Architecture\n\n### Overview\nThis epic creates the native platform configurations (Android and iOS) for the App Pasos Flutter application, enabling step tracking through platform-specific health APIs.\n\n### Architecture Pattern\n- **Standard Flutter platform setup** with health permissions\n- Android uses Gradle build system with Kotlin\n- iOS uses CocoaPods with Swift\n\n### Platform Requirements\n\n#### Android (API 21+)\n- **Gradle**: 8.x with AGP 8.1.0\n- **Kotlin**: 1.9.0\n- **Permissions**: ACTIVITY_RECOGNITION (step counting), FOREGROUND_SERVICE\n- **Package**: com.apppasos\n\n#### iOS (12.0+)\n- **CocoaPods**: Standard Flutter pod configuration\n- **Swift**: AppDelegate extending FlutterAppDelegate\n- **Entitlements**: HealthKit capability\n- **Privacy**: NSHealthShareUsageDescription, NSHealthUpdateUsageDescription\n- **Bundle ID**: com.apppasos\n\n### File Structure\n```\nandroid/\n‚îú‚îÄ‚îÄ build.gradle (root)\n‚îú‚îÄ‚îÄ settings.gradle\n‚îú‚îÄ‚îÄ gradle.properties\n‚îî‚îÄ‚îÄ app/\n    ‚îú‚îÄ‚îÄ build.gradle\n    ‚îî‚îÄ‚îÄ src/main/\n        ‚îú‚îÄ‚îÄ AndroidManifest.xml\n        ‚îî‚îÄ‚îÄ kotlin/com/apppasos/MainActivity.kt\n\nios/\n‚îú‚îÄ‚îÄ Podfile\n‚îî‚îÄ‚îÄ Runner/\n    ‚îú‚îÄ‚îÄ Info.plist\n    ‚îú‚îÄ‚îÄ AppDelegate.swift\n    ‚îî‚îÄ‚îÄ Runner.xcodeproj/project.pbxproj\n```\n\n### Dependencies Added to pubspec.yaml\n- `health: ^10.2.0` - Cross-platform health data access (HealthKit/Google Fit)\n- `permission_handler: ^11.0.1` - Runtime permission handling\n\n### Setup Commands\n```bash\nflutter pub get\n```\n\n### Verification Commands\n- **Typecheck**: `flutter analyze`\n- **Test**: `flutter test`\n- **Build Android**: `flutter build apk --debug`\n- **Build iOS**: `flutter build ios --no-codesign` (macOS only)",
    "stories": [
      {
        "id": "epic-platform-setup-story-1",
        "title": "Create Android Root Gradle Configuration in android/build.gradle, android/settings.gradle, android/gradle.properties",
        "description": "Create the root-level Android Gradle configuration files for the Flutter project.\n\nüîß **PATTERNS TO USE**:\n- Use standard Flutter Android Gradle template structure\n- Configure Gradle 8.x with Android Gradle Plugin 8.1.0\n- Set Kotlin version 1.9.0 for compatibility with Flutter 3.16+\n- Use ndkVersion '25.1.8937393' for native builds\n\nüì¶ **REQUIRED CONFIGURATIONS**:\n- android/build.gradle: Root build script with buildscript block containing repositories (google, mavenCentral), dependencies (AGP, Kotlin plugin)\n- android/settings.gradle: Include ':app' module, configure pluginManagement with Flutter plugin path\n- android/gradle.properties: JVM args (-Xmx4G), AndroidX enabled, Jetifier enabled, Kotlin code style\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID**:\n- DO NOT use deprecated 'compile' instead of 'implementation'\n- DO NOT use jcenter() repository (deprecated)\n- DO NOT set minSdk below 21 (Flutter requirement)\n\nüß™ **VERIFICATION**:\n- Files exist at correct paths\n- Gradle syntax is valid (no typos in DSL)\n- flutter pub get succeeds after setup",
        "epicId": "epic-platform-setup",
        "priority": 1,
        "estimatedComplexity": "simple",
        "dependencies": [],
        "status": "pending",
        "filesToRead": [
          "pubspec.yaml"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "android/build.gradle",
          "android/settings.gradle",
          "android/gradle.properties"
        ],
        "acceptanceCriteria": [
          "Given the android/ directory, When build.gradle is created, Then it contains buildscript with AGP 8.1.0 and Kotlin 1.9.0",
          "Given the android/ directory, When settings.gradle is created, Then it includes ':app' module and configures Flutter plugin",
          "Given the android/ directory, When gradle.properties is created, Then it enables AndroidX and Jetifier with 4GB heap"
        ]
      },
      {
        "id": "epic-platform-setup-story-2",
        "title": "Create Android App Configuration with Health Permissions in android/app/build.gradle, AndroidManifest.xml, MainActivity.kt",
        "description": "Create the Android app module configuration with health/activity recognition permissions for step tracking.\n\nüîß **PATTERNS TO USE**:\n- Use standard Flutter MainActivity extending FlutterActivity\n- Package name: com.apppasos (matches Kotlin directory structure)\n- Application ID: com.apppasos\n- Configure compileSdk 34, minSdk 21, targetSdk 34\n\nüì¶ **REQUIRED CONFIGURATIONS**:\n- android/app/build.gradle: Apply kotlin-android and flutter plugins, configure android block with namespace, compileSdk, defaultConfig (applicationId, minSdk, targetSdk, versionCode 1, versionName '1.0.0')\n- android/app/src/main/AndroidManifest.xml: Package com.apppasos, permissions for ACTIVITY_RECOGNITION (step counting), FOREGROUND_SERVICE, application block with Flutter-specific metadata\n- android/app/src/main/kotlin/com/apppasos/MainActivity.kt: Kotlin class extending FlutterActivity\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID**:\n- DO NOT forget ACTIVITY_RECOGNITION permission (required for step tracking on Android 10+)\n- DO NOT use Java instead of Kotlin (project uses Kotlin)\n- DO NOT hardcode version info (use flutterVersionCode/Name from local.properties)\n\nüß™ **VERIFICATION**:\n- AndroidManifest.xml contains ACTIVITY_RECOGNITION permission\n- MainActivity.kt compiles (extends FlutterActivity)\n- Package structure matches com.apppasos",
        "epicId": "epic-platform-setup",
        "priority": 1,
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "status": "pending",
        "filesToRead": [
          "pubspec.yaml",
          "lib/core/constants/app_constants.dart"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "android/app/build.gradle",
          "android/app/src/main/AndroidManifest.xml",
          "android/app/src/main/kotlin/com/apppasos/MainActivity.kt"
        ],
        "acceptanceCriteria": [
          "Given the android/app/ directory, When build.gradle is created, Then it configures applicationId 'com.apppasos' with compileSdk 34",
          "Given the AndroidManifest.xml, When permissions are declared, Then ACTIVITY_RECOGNITION permission is present for step tracking",
          "Given the kotlin/com/apppasos/ directory, When MainActivity.kt is created, Then it extends FlutterActivity correctly"
        ]
      },
      {
        "id": "epic-platform-setup-story-3",
        "title": "Create iOS Configuration with HealthKit Permissions in ios/Podfile, ios/Runner/Info.plist, ios/Runner/AppDelegate.swift",
        "description": "Create iOS configuration files with HealthKit entitlements and permissions for step tracking.\n\nüîß **PATTERNS TO USE**:\n- Use standard Flutter iOS template structure\n- Platform minimum: iOS 12.0 (required for modern HealthKit APIs)\n- Bundle identifier: com.apppasos\n- Swift-based AppDelegate extending FlutterAppDelegate\n\nüì¶ **REQUIRED CONFIGURATIONS**:\n- ios/Podfile: Set platform :ios, '12.0', use_frameworks!, configure Flutter pods path, post_install hook for build settings\n- ios/Runner/Info.plist: CFBundleName 'App Pasos', CFBundleIdentifier '$(PRODUCT_BUNDLE_IDENTIFIER)', NSHealthShareUsageDescription and NSHealthUpdateUsageDescription for HealthKit permissions, UIBackgroundModes for health\n- ios/Runner/AppDelegate.swift: Import UIKit and Flutter, @main AppDelegate extending FlutterAppDelegate with application(_:didFinishLaunchingWithOptions:) override\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID**:\n- DO NOT forget NSHealthShareUsageDescription (App Store rejection)\n- DO NOT forget NSHealthUpdateUsageDescription (App Store rejection)\n- DO NOT use Objective-C AppDelegate (project uses Swift)\n- DO NOT set iOS deployment target below 12.0\n\nüß™ **VERIFICATION**:\n- Info.plist contains HealthKit usage descriptions\n- Podfile sets iOS 12.0 minimum\n- AppDelegate.swift compiles (extends FlutterAppDelegate)",
        "epicId": "epic-platform-setup",
        "priority": 1,
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "status": "pending",
        "filesToRead": [
          "pubspec.yaml",
          "lib/core/constants/app_constants.dart"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "ios/Podfile",
          "ios/Runner/Info.plist",
          "ios/Runner/AppDelegate.swift"
        ],
        "acceptanceCriteria": [
          "Given the ios/ directory, When Podfile is created, Then it sets platform :ios '12.0' with use_frameworks!",
          "Given the ios/Runner/Info.plist, When HealthKit permissions are declared, Then NSHealthShareUsageDescription and NSHealthUpdateUsageDescription are present",
          "Given the ios/Runner/ directory, When AppDelegate.swift is created, Then it extends FlutterAppDelegate with @main annotation"
        ]
      },
      {
        "id": "epic-platform-setup-story-4",
        "title": "Create iOS Xcode Project Configuration in ios/Runner.xcodeproj/project.pbxproj and update pubspec.yaml with platform dependencies",
        "description": "Create the Xcode project configuration and update pubspec.yaml with health-related Flutter dependencies.\n\nüîß **PATTERNS TO USE**:\n- Standard Flutter Xcode project.pbxproj structure\n- PRODUCT_BUNDLE_IDENTIFIER = com.apppasos\n- DEVELOPMENT_TEAM placeholder for signing\n- Add health package to pubspec.yaml for cross-platform health data access\n\nüì¶ **REQUIRED CONFIGURATIONS**:\n- ios/Runner.xcodeproj/project.pbxproj: Xcode project with Runner target, build configurations (Debug, Release, Profile), HealthKit capability in entitlements, IPHONEOS_DEPLOYMENT_TARGET = 12.0\n- pubspec.yaml: Add 'health: ^10.2.0' dependency for HealthKit/Google Fit integration, add 'permission_handler: ^11.0.1' for runtime permissions\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID**:\n- DO NOT forget HealthKit entitlement in build settings\n- DO NOT add conflicting health packages (use 'health' package only)\n- DO NOT modify existing pubspec.yaml structure (only add to dependencies section)\n\nüß™ **VERIFICATION**:\n- project.pbxproj has valid Xcode project structure\n- pubspec.yaml contains health and permission_handler dependencies\n- flutter pub get succeeds after changes",
        "epicId": "epic-platform-setup",
        "priority": 2,
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "status": "pending",
        "filesToRead": [
          "pubspec.yaml"
        ],
        "filesToModify": [
          "pubspec.yaml"
        ],
        "filesToCreate": [
          "ios/Runner.xcodeproj/project.pbxproj"
        ],
        "acceptanceCriteria": [
          "Given the ios/Runner.xcodeproj/ directory, When project.pbxproj is created, Then it contains Runner target with PRODUCT_BUNDLE_IDENTIFIER = com.apppasos",
          "Given the project.pbxproj, When build settings are configured, Then IPHONEOS_DEPLOYMENT_TARGET = 12.0 and HealthKit capability is enabled",
          "Given pubspec.yaml, When dependencies are updated, Then health ^10.2.0 and permission_handler ^11.0.1 are added"
        ]
      }
    ]
  }
}