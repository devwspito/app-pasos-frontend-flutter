{
  "_metadata": {
    "agentType": "techlead",
    "taskId": "1bb751c1ac1b94470511c071",
    "timestamp": "2026-01-31T18:14:59.030Z",
    "phase": "techlead",
    "epicId": "epic-frontend-profile",
    "savedAt": "2026-01-31T18:14:59.030Z",
    "version": "1.0"
  },
  "data": {
    "epicId": "epic-frontend-profile",
    "storiesCount": 3,
    "architecture": "## Architecture Overview\n\nThis epic implements a Profile feature following Clean Architecture with BLoC pattern, consistent with the existing codebase patterns (AuthBloc, SharingBloc, GoalsBloc).\n\n### Layer Structure\n\n```\nlib/features/profile/\n‚îú‚îÄ‚îÄ presentation/\n‚îÇ   ‚îú‚îÄ‚îÄ bloc/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile_bloc.dart       # State management\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile_event.dart      # User actions\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile_state.dart      # UI states\n‚îÇ   ‚îú‚îÄ‚îÄ pages/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile_page.dart       # Main page\n‚îÇ   ‚îî‚îÄ‚îÄ widgets/\n‚îÇ       ‚îú‚îÄ‚îÄ profile_header.dart     # Avatar + name display\n‚îÇ       ‚îî‚îÄ‚îÄ profile_form.dart       # Editable form\n‚îú‚îÄ‚îÄ domain/\n‚îÇ   ‚îú‚îÄ‚îÄ repositories/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile_repository.dart # Abstract interface\n‚îÇ   ‚îî‚îÄ‚îÄ usecases/\n‚îÇ       ‚îú‚îÄ‚îÄ get_profile_usecase.dart\n‚îÇ       ‚îî‚îÄ‚îÄ update_profile_usecase.dart\n‚îî‚îÄ‚îÄ data/\n    ‚îú‚îÄ‚îÄ repositories/\n    ‚îÇ   ‚îî‚îÄ‚îÄ profile_repository_impl.dart\n    ‚îî‚îÄ‚îÄ datasources/\n        ‚îî‚îÄ‚îÄ profile_remote_datasource.dart\n```\n\n### Data Flow\n\n1. **UI ‚Üí Bloc**: User taps Edit/Save ‚Üí ProfileEvent dispatched\n2. **Bloc ‚Üí UseCase**: Bloc handler calls UseCase.call()\n3. **UseCase ‚Üí Repository**: UseCase delegates to repository interface\n4. **Repository ‚Üí DataSource**: Implementation calls datasource\n5. **DataSource ‚Üí API**: Makes HTTP request via ApiClient\n6. **Response bubbles back up** through same layers\n\n### API Integration\n\n- GET `/api/users/profile` - Fetch current user profile\n- PUT `/api/users/profile` - Update profile with `{name, email}`\n\nEndpoints already defined in `ApiEndpoints.userProfile` and `ApiEndpoints.updateProfile`.\n\n### Reused Components\n\n- **User entity**: `lib/features/auth/domain/entities/user.dart`\n- **UserModel**: `lib/features/auth/data/models/user_model.dart`\n- **ApiClient**: `lib/core/network/api_client.dart`\n- **AppScaffold**: `lib/shared/widgets/app_scaffold.dart`\n- **AppTextField**: `lib/shared/widgets/app_text_field.dart`\n- **AppButton**: `lib/shared/widgets/app_button.dart`\n- **AvatarWidget**: `lib/shared/widgets/avatar_widget.dart`\n- **LoadingIndicator**: `lib/shared/widgets/loading_indicator.dart`\n\n### SOLID Compliance\n\n- **SRP**: Each class has single responsibility (Bloc manages state, UseCase contains business logic, Repository abstracts data access)\n- **OCP**: New profile features can be added without modifying existing code\n- **LSP**: ProfileRepositoryImpl substitutes ProfileRepository interface\n- **ISP**: ProfileRepository interface only has methods profile feature needs\n- **DIP**: ProfileBloc depends on UseCase abstractions, not DataSource implementations\n\n### Verification Commands\n\n```bash\n# Typecheck\nflutter analyze\n\n# Test (when tests are added)\nflutter test\n\n# Lint\nflutter analyze --no-fatal-infos\n```",
    "stories": [
      {
        "id": "epic-frontend-profile-story-1",
        "title": "Create ProfileBloc with events and states in lib/features/profile/presentation/bloc/",
        "description": "Implement the BLoC for profile management following the existing AuthBloc pattern.\n\nüîí **SCOPE BOUNDARY:**\n- You can ONLY create/modify files listed below\n- Creating ANY other file is a scope violation\n\nüìÅ **FILES:**\n- Read: lib/features/auth/presentation/bloc/auth_bloc.dart, lib/features/auth/presentation/bloc/auth_event.dart, lib/features/auth/presentation/bloc/auth_state.dart\n- Modify: NONE\n- Create: lib/features/profile/presentation/bloc/profile_bloc.dart, lib/features/profile/presentation/bloc/profile_event.dart, lib/features/profile/presentation/bloc/profile_state.dart\n\nüîß **PATTERNS TO USE:**\n- Use sealed class pattern for ProfileEvent (like AuthEvent in auth_event.dart)\n- Use sealed class pattern for ProfileState (like AuthState in auth_state.dart)\n- Use Equatable for value comparison (import 'package:equatable/equatable.dart')\n- Bloc constructor takes use cases as named required parameters\n- Event handlers are private methods: `_onEventName(Event event, Emitter<State> emit)`\n- Use `on<EventType>(_onEventName);` in constructor to register handlers\n- Import User entity from 'package:app_pasos_frontend/features/auth/domain/entities/user.dart'\n\nüì¶ **REQUIRED STRUCTURE:**\n\n**profile_event.dart:**\n```dart\nsealed class ProfileEvent extends Equatable {\n  const ProfileEvent();\n}\n\nfinal class ProfileLoadRequested extends ProfileEvent {\n  const ProfileLoadRequested();\n  @override\n  List<Object?> get props => [];\n}\n\nfinal class ProfileUpdateRequested extends ProfileEvent {\n  const ProfileUpdateRequested({required this.name, required this.email});\n  final String name;\n  final String email;\n  @override\n  List<Object?> get props => [name, email];\n}\n```\n\n**profile_state.dart:**\n```dart\nsealed class ProfileState extends Equatable {\n  const ProfileState();\n}\n\nfinal class ProfileInitial extends ProfileState {...}\nfinal class ProfileLoading extends ProfileState {...}\nfinal class ProfileLoaded extends ProfileState {\n  const ProfileLoaded({required this.user});\n  final User user;\n  ...\n}\nfinal class ProfileUpdating extends ProfileState {\n  const ProfileUpdating({required this.user});\n  final User user;\n  ...\n}\nfinal class ProfileUpdateSuccess extends ProfileState {\n  const ProfileUpdateSuccess({required this.user});\n  final User user;\n  ...\n}\nfinal class ProfileError extends ProfileState {\n  const ProfileError({required this.message});\n  final String message;\n  ...\n}\n```\n\n**profile_bloc.dart:**\n```dart\nclass ProfileBloc extends Bloc<ProfileEvent, ProfileState> {\n  ProfileBloc({\n    required GetProfileUseCase getProfileUseCase,\n    required UpdateProfileUseCase updateProfileUseCase,\n  }) : _getProfileUseCase = getProfileUseCase,\n       _updateProfileUseCase = updateProfileUseCase,\n       super(const ProfileInitial()) {\n    on<ProfileLoadRequested>(_onLoadRequested);\n    on<ProfileUpdateRequested>(_onUpdateRequested);\n  }\n  // Handler implementations follow AuthBloc pattern\n}\n```\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID:**\n- Do NOT use `class` instead of `sealed class` for base event/state\n- Do NOT use `abstract class` - use `sealed class` (Dart 3 pattern)\n- Do NOT forget to extend Equatable\n- Do NOT forget `library;` at top of each file\n- Do NOT import from data layer - only import from domain layer\n\n**VERIFICATION:**\n1. Run `flutter analyze lib/features/profile/presentation/bloc/` - no errors\n2. Check all files have proper dartdoc comments\n3. Verify sealed classes enable exhaustive pattern matching",
        "epicId": "epic-frontend-profile",
        "priority": 1,
        "estimatedComplexity": "moderate",
        "dependencies": [],
        "status": "pending",
        "filesToRead": [
          "lib/features/auth/presentation/bloc/auth_bloc.dart",
          "lib/features/auth/presentation/bloc/auth_event.dart",
          "lib/features/auth/presentation/bloc/auth_state.dart",
          "lib/features/auth/domain/entities/user.dart"
        ],
        "filesToModify": [],
        "filesToCreate": [
          "lib/features/profile/presentation/bloc/profile_bloc.dart",
          "lib/features/profile/presentation/bloc/profile_event.dart",
          "lib/features/profile/presentation/bloc/profile_state.dart"
        ],
        "acceptanceCriteria": [
          "Given ProfileLoadRequested event is added, When ProfileBloc processes it, Then it emits ProfileLoading then ProfileLoaded(user) or ProfileError(message)",
          "Given ProfileUpdateRequested event with name and email, When ProfileBloc processes it, Then it emits ProfileUpdating then ProfileUpdateSuccess(user) or ProfileError(message)",
          "Given sealed class pattern is used, When compiler checks exhaustive switch, Then all state types are enforced",
          "Given profile_event.dart file, When it contains ProfileLoadRequested and ProfileUpdateRequested, Then both extend ProfileEvent sealed class",
          "Given profile_state.dart file, When it contains all states (Initial, Loading, Loaded, Updating, UpdateSuccess, Error), Then all extend ProfileState sealed class"
        ]
      },
      {
        "id": "epic-frontend-profile-story-2",
        "title": "Create profile repository, datasource, and usecases in lib/features/profile/",
        "description": "Implement the data and domain layers for profile operations following Clean Architecture.\n\nüîí **SCOPE BOUNDARY:**\n- You can ONLY create/modify files listed below\n- Creating ANY other file is a scope violation\n\nüìÅ **FILES:**\n- Read: lib/features/auth/data/repositories/auth_repository_impl.dart, lib/features/auth/data/datasources/auth_remote_datasource.dart, lib/features/auth/domain/repositories/auth_repository.dart, lib/features/auth/domain/usecases/login_usecase.dart, lib/core/network/api_endpoints.dart, lib/features/auth/data/models/user_model.dart\n- Modify: lib/core/di/injection_container.dart\n- Create: lib/features/profile/domain/repositories/profile_repository.dart, lib/features/profile/domain/usecases/get_profile_usecase.dart, lib/features/profile/domain/usecases/update_profile_usecase.dart, lib/features/profile/data/repositories/profile_repository_impl.dart, lib/features/profile/data/datasources/profile_remote_datasource.dart\n\nüîß **PATTERNS TO USE:**\n\n**Domain Layer (profile_repository.dart):**\n```dart\nabstract interface class ProfileRepository {\n  Future<User> getProfile();\n  Future<User> updateProfile({required String name, required String email});\n}\n```\n\n**UseCase Pattern (get_profile_usecase.dart):**\n```dart\nclass GetProfileUseCase {\n  GetProfileUseCase({required ProfileRepository repository}) : _repository = repository;\n  final ProfileRepository _repository;\n  Future<User> call() async => _repository.getProfile();\n}\n```\n\n**UseCase with Params (update_profile_usecase.dart):**\n```dart\nclass UpdateProfileParams extends Equatable {\n  const UpdateProfileParams({required this.name, required this.email});\n  final String name;\n  final String email;\n  @override\n  List<Object?> get props => [name, email];\n}\n\nclass UpdateProfileUseCase {\n  UpdateProfileUseCase({required ProfileRepository repository}) : _repository = repository;\n  final ProfileRepository _repository;\n  Future<User> call(UpdateProfileParams params) async =>\n    _repository.updateProfile(name: params.name, email: params.email);\n}\n```\n\n**DataSource Pattern (profile_remote_datasource.dart):**\n```dart\nabstract interface class ProfileRemoteDatasource {\n  Future<UserModel> getProfile();\n  Future<UserModel> updateProfile({required String name, required String email});\n}\n\nclass ProfileRemoteDatasourceImpl implements ProfileRemoteDatasource {\n  ProfileRemoteDatasourceImpl({required ApiClient client}) : _client = client;\n  final ApiClient _client;\n\n  @override\n  Future<UserModel> getProfile() async {\n    final response = await _client.get<Map<String, dynamic>>(ApiEndpoints.userProfile);\n    final data = response.data;\n    if (data == null) throw const ServerException(message: 'Invalid response', code: 'INVALID_RESPONSE');\n    final userData = data['user'] as Map<String, dynamic>? ?? data;\n    return UserModel.fromJson(userData);\n  }\n\n  @override\n  Future<UserModel> updateProfile({required String name, required String email}) async {\n    final response = await _client.put<Map<String, dynamic>>(\n      ApiEndpoints.updateProfile,\n      data: {'name': name, 'email': email},\n    );\n    final data = response.data;\n    if (data == null) throw const ServerException(message: 'Invalid response', code: 'INVALID_RESPONSE');\n    final userData = data['user'] as Map<String, dynamic>? ?? data;\n    return UserModel.fromJson(userData);\n  }\n}\n```\n\n**Repository Impl (profile_repository_impl.dart):**\n```dart\nclass ProfileRepositoryImpl implements ProfileRepository {\n  ProfileRepositoryImpl({required ProfileRemoteDatasource datasource}) : _datasource = datasource;\n  final ProfileRemoteDatasource _datasource;\n\n  @override\n  Future<User> getProfile() => _datasource.getProfile();\n\n  @override\n  Future<User> updateProfile({required String name, required String email}) =>\n    _datasource.updateProfile(name: name, email: email);\n}\n```\n\n**DI Registration (add to injection_container.dart):**\nAdd a new section `// Profile Feature` after Goals Feature section:\n```dart\n// ============================================================\n// Profile Feature\n// ============================================================\n\n// Data Sources\nsl.registerLazySingleton<ProfileRemoteDatasource>(\n  () => ProfileRemoteDatasourceImpl(client: sl<ApiClient>()),\n);\n\n// Repositories\nsl.registerLazySingleton<ProfileRepository>(\n  () => ProfileRepositoryImpl(datasource: sl<ProfileRemoteDatasource>()),\n);\n\n// Use Cases\nsl.registerLazySingleton<GetProfileUseCase>(\n  () => GetProfileUseCase(repository: sl<ProfileRepository>()),\n);\nsl.registerLazySingleton<UpdateProfileUseCase>(\n  () => UpdateProfileUseCase(repository: sl<ProfileRepository>()),\n);\n\n// Blocs (Factory - new instance per use)\nsl.registerFactory<ProfileBloc>(\n  () => ProfileBloc(\n    getProfileUseCase: sl<GetProfileUseCase>(),\n    updateProfileUseCase: sl<UpdateProfileUseCase>(),\n  ),\n);\n```\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID:**\n- Do NOT use `abstract class` - use `abstract interface class` for interfaces\n- Do NOT import Bloc in data/domain layers - only in presentation\n- Do NOT call ApiClient directly in repository - use datasource\n- Do NOT use direct fetch() - always use sl<ApiClient>()\n- Do NOT forget imports for ProfileBloc, ProfileRemoteDatasource, ProfileRepository, GetProfileUseCase, UpdateProfileUseCase in injection_container.dart\n\n**API ENDPOINTS (already exist in api_endpoints.dart):**\n- GET profile: `ApiEndpoints.userProfile` = '/users/profile'\n- PUT update: `ApiEndpoints.updateProfile` = '/users/profile'\n\n**VERIFICATION:**\n1. Run `flutter analyze lib/features/profile/` - no errors\n2. Run `flutter analyze lib/core/di/injection_container.dart` - no errors",
        "epicId": "epic-frontend-profile",
        "priority": 2,
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-frontend-profile-story-1"
        ],
        "status": "pending",
        "filesToRead": [
          "lib/features/auth/data/repositories/auth_repository_impl.dart",
          "lib/features/auth/data/datasources/auth_remote_datasource.dart",
          "lib/features/auth/domain/repositories/auth_repository.dart",
          "lib/features/auth/domain/usecases/login_usecase.dart",
          "lib/core/network/api_endpoints.dart",
          "lib/features/auth/data/models/user_model.dart"
        ],
        "filesToModify": [
          "lib/core/di/injection_container.dart"
        ],
        "filesToCreate": [
          "lib/features/profile/domain/repositories/profile_repository.dart",
          "lib/features/profile/domain/usecases/get_profile_usecase.dart",
          "lib/features/profile/domain/usecases/update_profile_usecase.dart",
          "lib/features/profile/data/repositories/profile_repository_impl.dart",
          "lib/features/profile/data/datasources/profile_remote_datasource.dart"
        ],
        "acceptanceCriteria": [
          "Given getProfile() is called on ProfileRemoteDatasource, When API call succeeds, Then it returns UserModel from GET /api/users/profile",
          "Given updateProfile(name, email) is called, When API call succeeds, Then it returns updated UserModel from PUT /api/users/profile",
          "Given ProfileRepository is registered in DI, When sl<ProfileRepository>() is called, Then it returns ProfileRepositoryImpl instance",
          "Given GetProfileUseCase and UpdateProfileUseCase are created, When injected into ProfileBloc, Then the DI resolves all dependencies correctly",
          "Given API call fails, When datasource throws ServerException, Then it propagates to repository caller"
        ]
      },
      {
        "id": "epic-frontend-profile-story-3",
        "title": "Create ProfilePage UI with header and form in lib/features/profile/presentation/",
        "description": "Implement the ProfilePage UI with editable profile form following existing page patterns.\n\nüîí **SCOPE BOUNDARY:**\n- You can ONLY create/modify files listed below\n- Creating ANY other file is a scope violation\n\nüìÅ **FILES:**\n- Read: lib/features/auth/presentation/pages/login_page.dart, lib/shared/widgets/app_scaffold.dart, lib/shared/widgets/app_text_field.dart, lib/shared/widgets/app_button.dart, lib/shared/widgets/avatar_widget.dart, lib/shared/widgets/loading_indicator.dart, lib/core/router/app_router.dart\n- Modify: lib/core/router/app_router.dart\n- Create: lib/features/profile/presentation/pages/profile_page.dart, lib/features/profile/presentation/widgets/profile_header.dart, lib/features/profile/presentation/widgets/profile_form.dart\n\nüîß **PATTERNS TO USE:**\n\n**Profile Page (profile_page.dart):**\n```dart\nimport 'package:app_pasos_frontend/features/profile/presentation/bloc/profile_bloc.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/bloc/profile_event.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/bloc/profile_state.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/widgets/profile_form.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/widgets/profile_header.dart';\nimport 'package:app_pasos_frontend/shared/widgets/app_scaffold.dart';\nimport 'package:app_pasos_frontend/shared/widgets/loading_indicator.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_bloc/flutter_bloc.dart';\n\nclass ProfilePage extends StatefulWidget {\n  const ProfilePage({super.key});\n\n  @override\n  State<ProfilePage> createState() => _ProfilePageState();\n}\n\nclass _ProfilePageState extends State<ProfilePage> {\n  bool _isEditing = false;\n  late TextEditingController _nameController;\n  late TextEditingController _emailController;\n\n  @override\n  void initState() {\n    super.initState();\n    _nameController = TextEditingController();\n    _emailController = TextEditingController();\n  }\n\n  @override\n  void dispose() {\n    _nameController.dispose();\n    _emailController.dispose();\n    super.dispose();\n  }\n\n  void _onEditPressed(User user) {\n    setState(() {\n      _isEditing = true;\n      _nameController.text = user.name;\n      _emailController.text = user.email;\n    });\n  }\n\n  void _onCancelPressed(User user) {\n    setState(() {\n      _isEditing = false;\n      _nameController.text = user.name;\n      _emailController.text = user.email;\n    });\n  }\n\n  void _onSavePressed() {\n    context.read<ProfileBloc>().add(\n      ProfileUpdateRequested(\n        name: _nameController.text,\n        email: _emailController.text,\n      ),\n    );\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return AppScaffold(\n      title: 'Profile',\n      body: BlocConsumer<ProfileBloc, ProfileState>(\n        listener: (context, state) {\n          if (state is ProfileUpdateSuccess) {\n            setState(() => _isEditing = false);\n            ScaffoldMessenger.of(context).showSnackBar(\n              const SnackBar(content: Text('Profile updated successfully')),\n            );\n          } else if (state is ProfileError) {\n            ScaffoldMessenger.of(context).showSnackBar(\n              SnackBar(\n                content: Text(state.message),\n                backgroundColor: Theme.of(context).colorScheme.error,\n              ),\n            );\n          }\n        },\n        builder: (context, state) {\n          return switch (state) {\n            ProfileInitial() || ProfileLoading() => const LoadingIndicator(),\n            ProfileLoaded(:final user) || ProfileUpdating(:final user) || ProfileUpdateSuccess(:final user) => _buildContent(user, state is ProfileUpdating),\n            ProfileError(:final message) => Center(child: Text(message)),\n          };\n        },\n      ),\n    );\n  }\n\n  Widget _buildContent(User user, bool isUpdating) {\n    return SingleChildScrollView(\n      padding: const EdgeInsets.all(24),\n      child: Column(\n        children: [\n          ProfileHeader(user: user),\n          const SizedBox(height: 32),\n          ProfileForm(\n            nameController: _nameController,\n            emailController: _emailController,\n            isEditing: _isEditing,\n            isLoading: isUpdating,\n            onEdit: () => _onEditPressed(user),\n            onCancel: () => _onCancelPressed(user),\n            onSave: _onSavePressed,\n          ),\n        ],\n      ),\n    );\n  }\n}\n```\n\n**Profile Header Widget (profile_header.dart):**\n```dart\nimport 'package:app_pasos_frontend/features/auth/domain/entities/user.dart';\nimport 'package:app_pasos_frontend/shared/widgets/avatar_widget.dart';\nimport 'package:flutter/material.dart';\n\nclass ProfileHeader extends StatelessWidget {\n  const ProfileHeader({required this.user, super.key});\n  final User user;\n\n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n    return Column(\n      children: [\n        AvatarWidget(name: user.name, size: 100),\n        const SizedBox(height: 16),\n        Text(\n          user.name,\n          style: theme.textTheme.headlineSmall?.copyWith(fontWeight: FontWeight.bold),\n        ),\n        const SizedBox(height: 4),\n        Text(\n          user.email,\n          style: theme.textTheme.bodyMedium?.copyWith(\n            color: theme.colorScheme.onSurfaceVariant,\n          ),\n        ),\n      ],\n    );\n  }\n}\n```\n\n**Profile Form Widget (profile_form.dart):**\n```dart\nimport 'package:app_pasos_frontend/shared/widgets/app_button.dart';\nimport 'package:app_pasos_frontend/shared/widgets/app_text_field.dart';\nimport 'package:flutter/material.dart';\n\nclass ProfileForm extends StatelessWidget {\n  const ProfileForm({\n    required this.nameController,\n    required this.emailController,\n    required this.isEditing,\n    required this.isLoading,\n    required this.onEdit,\n    required this.onCancel,\n    required this.onSave,\n    super.key,\n  });\n\n  final TextEditingController nameController;\n  final TextEditingController emailController;\n  final bool isEditing;\n  final bool isLoading;\n  final VoidCallback onEdit;\n  final VoidCallback onCancel;\n  final VoidCallback onSave;\n\n  @override\n  Widget build(BuildContext context) {\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.stretch,\n      children: [\n        AppTextField(\n          controller: nameController,\n          labelText: 'Name',\n          prefixIcon: Icons.person_outline,\n          enabled: isEditing,\n        ),\n        const SizedBox(height: 16),\n        AppTextField(\n          controller: emailController,\n          labelText: 'Email',\n          keyboardType: TextInputType.emailAddress,\n          prefixIcon: Icons.email_outlined,\n          enabled: isEditing,\n        ),\n        const SizedBox(height: 24),\n        if (!isEditing)\n          AppButton(\n            text: 'Edit Profile',\n            onPressed: onEdit,\n            leadingIcon: Icons.edit,\n            fullWidth: true,\n          )\n        else\n          Row(\n            children: [\n              Expanded(\n                child: AppButton(\n                  text: 'Cancel',\n                  onPressed: isLoading ? null : onCancel,\n                  variant: ButtonVariant.outline,\n                ),\n              ),\n              const SizedBox(width: 16),\n              Expanded(\n                child: AppButton(\n                  text: 'Save',\n                  onPressed: isLoading ? null : onSave,\n                  isLoading: isLoading,\n                ),\n              ),\n            ],\n          ),\n      ],\n    );\n  }\n}\n```\n\n**Router Update (app_router.dart):**\nReplace the placeholder Profile route with:\n```dart\nGoRoute(\n  path: RouteNames.profile,\n  name: 'profile',\n  builder: (context, state) => BlocProvider(\n    create: (_) => sl<ProfileBloc>()..add(const ProfileLoadRequested()),\n    child: const ProfilePage(),\n  ),\n),\n```\n\nAdd imports at top of app_router.dart:\n```dart\nimport 'package:app_pasos_frontend/features/profile/presentation/bloc/profile_bloc.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/bloc/profile_event.dart';\nimport 'package:app_pasos_frontend/features/profile/presentation/pages/profile_page.dart';\n```\n\n‚ö†Ô∏è **ANTI-PATTERNS TO AVOID:**\n- Do NOT use raw Scaffold - use AppScaffold from shared widgets\n- Do NOT use raw TextField - use AppTextField from shared widgets\n- Do NOT use raw ElevatedButton - use AppButton from shared widgets\n- Do NOT use CircleAvatar directly - use AvatarWidget from shared widgets\n- Do NOT use \"Coming Soon\" or placeholder text - implement fully functional UI\n- Do NOT forget to add `library;` at top of each file\n- Do NOT forget BlocProvider wrapper in router\n\n**VERIFICATION:**\n1. Run `flutter analyze lib/features/profile/presentation/` - no errors\n2. Run `flutter analyze lib/core/router/app_router.dart` - no errors\n3. UI shows avatar, name, email from loaded user\n4. Edit button enables form fields\n5. Save button triggers ProfileUpdateRequested event\n6. Cancel button reverts to original values\n7. Loading indicator shows during save\n8. SnackBar shows success/error messages",
        "epicId": "epic-frontend-profile",
        "priority": 3,
        "estimatedComplexity": "moderate",
        "dependencies": [
          "epic-frontend-profile-story-1",
          "epic-frontend-profile-story-2"
        ],
        "status": "pending",
        "filesToRead": [
          "lib/features/auth/presentation/pages/login_page.dart",
          "lib/shared/widgets/app_scaffold.dart",
          "lib/shared/widgets/app_text_field.dart",
          "lib/shared/widgets/app_button.dart",
          "lib/shared/widgets/avatar_widget.dart",
          "lib/shared/widgets/loading_indicator.dart",
          "lib/core/router/app_router.dart"
        ],
        "filesToModify": [
          "lib/core/router/app_router.dart"
        ],
        "filesToCreate": [
          "lib/features/profile/presentation/pages/profile_page.dart",
          "lib/features/profile/presentation/widgets/profile_header.dart",
          "lib/features/profile/presentation/widgets/profile_form.dart"
        ],
        "acceptanceCriteria": [
          "Given user navigates to /profile route, When ProfilePage loads, Then it displays ProfileHeader with avatar, name, and email",
          "Given ProfilePage is in view mode, When user taps Edit button, Then form fields become editable with current values",
          "Given ProfilePage is in edit mode, When user taps Save button, Then ProfileUpdateRequested event is dispatched with form values",
          "Given update is in progress, When ProfileBloc emits ProfileUpdating, Then Save button shows loading indicator",
          "Given update succeeds, When ProfileBloc emits ProfileUpdateSuccess, Then success SnackBar is shown and edit mode exits",
          "Given update fails, When ProfileBloc emits ProfileError, Then error SnackBar is shown with error message",
          "Given ProfilePage is in edit mode, When user taps Cancel button, Then form values revert to original and edit mode exits"
        ]
      }
    ]
  }
}